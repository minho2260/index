<!DOCTYPE html>
<html lang="ko">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styles.css">
    
    <title>상속세셀프계산기</title>
   
</head>
<body>

<section class="section">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="text-wrapper">
                    <h1>상속세 절세 보고서 (P)</h1>

                    <table border="1">
                        <tbody><tr><td>
                                     <h3>◈ 기본사항</h3>
                                        <ol>
                                            <li>부모님중 한분이 먼저 돌아가신 경우.</li>
                                            <li>피상속인(돌아가신분)이 1주택과 그외 자산을 소유.</li>
                                            <li>자산과 부채는 사망일 당시금액. 사망신고일이 아님 유의.</li>

                                        </ol>
                                  </td>
                             </tr>
                    </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div> 






    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="cal-wrapper">


                    <div id="step1" style="display: block;">

                        <button onclick="loadAllData()">입력 데이터 불러오기</button> <br><br>

                        <h2>주택가격</h2>
                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
                             <input type="text" id="houseValue" inputmode="numeric" oninput="formatNumber(this)" placeholder="주택가격 ">                            <ul>
                                <li>시가평가 원칙.</li>
                                <li>시가는 이 주택의 감정평가액 또는 매매사례가액.</li>
                                <li>시가가 없는 경우 기준시가 평가.</li>                                
                            </ul>
                            <div class="no-print">
                                <strong><a href="https://tuzaga.com/%ec%83%81%ec%86%8d%ec%8b%9c-%ec%95%84%ed%8c%8c%ed%8a%b8-%ed%8f%89%ea%b0%80/" target="_blank" style="color: #e74c3c;">⚠️ 상속주택 평가교실  바로가기  꼭 ~~ 클릭 !!! ⚠️</a></strong>
                            

                                <ul>
                                
                                    <li><a href="https://www.hometax.go.kr/" target="_blank">🏠 홈텍스 실거래가</a></li>
                                    <li><a href="https://rt.molit.go.kr/" target="_blank">🏢 국토교통부 실거래가</a></li>
                                    <li><a href="https://www.realtyprice.kr/" target="_blank">📈 국토교통부 공시가격</a></li>
                                </ul>
                            </div>
                            <button onclick="nextStep(2)">다음</button>
                        </div>

                    </div>


                    <div id="step2" style="display: none;">
                        <h2>비주거용건물(대지 포함) </h2>
                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
                            <input type="text" id="buildingValue" inputmode="numeric" oninput="formatNumber(this)">
                            <ul>
                                <li>시가 평가 원칙.</li>
                                <li>감정평가가액이 있는 경우 감정가액.</li>
                                <li>시가가 없는 경우 기준시가로 평가.</li>
                                <li>고가의 건물의 경우, 2020년부터 기준시가로 과세하는 것에 대한 과세 형평성 문제가 제기되었습니다.</li>
                                <li>국세청은 자체 감정평가예산을 배정하여 예상감정가와 시가의 차액이 10억을 넘거나 ,
                                    10%이상 차이가 나는 경우 감정평가를 하여 과세하고 있습니다.
                                    </li>
                            </ul>
                            <div class="no-print">
                                <strong><a href="https://tuzaga.com/%ea%b1%b4%eb%ac%bc%ec%9d%98-%ea%b0%90%ec%a0%95%ed%8f%89%ea%b0%80%ec%99%80-%eb%b3%b4%ec%b6%a9%ec%a0%81-%ed%8f%89%ea%b0%80%eb%b0%a9%eb%b2%95/" target="_blank" style="color: #e74c3c;">⚠️상속 건물평가 교실 꼭 ~~ 클릭 !!! ⚠️</a></strong>

                                <ul>                                
                                    <li><a href="https://www.hometax.go.kr/"target="_blank">🏢 비주거용 건물평가하러 가기 :홈텍스 </a> </li>                                
                                </ul>
                            </div>
                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(1)">뒤로가기</button>
                                <button onclick="nextStep(3)">다음</button>
                            </div>
                        </div>

                    </div>


                    <div id="step3" style="display: none;">
                        <h2> 농지 </h2>
                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
                            <input type="text" id="agriculturalLandValue" inputmode="numeric" oninput="formatNumber(this)">
                            <ul>
                                <li>시가로 평가.</li>
                                <li>감정평가로 평가 할수 있음</li>
                                <li>시가가 없는 경우 기준시가로 평가.</li>
                            </ul>
                            <div class="no-print">
                                <strong><a href="https://tuzaga.com/%ec%83%81%ec%86%8d%eb%86%8d%ec%a7%80-%ed%8f%89%ea%b0%80/" target="_blank" style="color: #e74c3c;">⚠️상속농지 평가 교실 바로가기 중요 ⚠️</a></strong>

                                <ul>                                
                                    <li><a href="https://www.realtyprice.kr/" target="_blank"> 🏢 상속농지 평가하러 가기 : 국토교통부 공시가격 </a> </li>                                
                                </ul>
                            </div>
                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(2)">뒤로가기</button>
                                <button onclick="nextStep(4)">다음</button>
                            </div>
                        </div>


                    </div>


                    <div id="step4" style="display: none;">
                        <h2>임야(산) </h2>
                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
                            <input type="text" id="forestLandValue" inputmode="numeric" oninput="formatNumber(this)">

                            <ul>
                                <li>시가로 평가.</li>
                                <li>감정평가로 평가 할수 있음</li>
                                <li>시가가 없는 경우 기준시가로 평가.</li>
                            </ul>
                            <div class="no-print">
                                <strong><a href="https://tuzaga.com/%ec%83%81%ec%86%8d%eb%86%8d%ec%a7%80-%ed%8f%89%ea%b0%80/" target="_blank" style="color: #e74c3c;">⚠️상속임야 평가 교실 바로가기 중요 ⚠️</a></strong>

                                <ul>                                
                                    <li><a href="https://www.realtyprice.kr/" target="_blank"> 🏢 임야 평가하러 가기 : 국토교통부 공시가격 </a> </li>                                
                                </ul>
                            </div>
                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(3)">뒤로가기</button>
                                <button onclick="nextStep(5)">다음</button>
                            </div>
                        </div>

                    </div>


                    <div id="step5" style="display: none;">
                        <h2>금융자산 등 그외상속재산</h2>
                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
                            <input type="text" id="otherProperty" inputmode="numeric" oninput="formatNumber(this)">
                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(4)">뒤로가기</button>
                                <button onclick="nextStep(6)">다음</button>
                            </div>
                        </div>
                    </div>


                    <div id="step6" style="display: none;">
                        <h2>채무 및 공과금</h2>
                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
                            <input type="text" id="debts" inputmode="numeric" oninput="formatNumber(this)">
                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(5)">뒤로가기</button>
                                <button onclick="nextStep(7)">다음</button>
                            </div>
                        </div>
                    </div>


                    <div id="step7" style="display: none;">
                        <h2>장례비용</h2>
                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
                            <input type="text" id="funeralExpense" inputmode="numeric" oninput="formatNumber(this)" placeholder="5백이하시 5,000,000을 쓰세요">
                            <ul>
                                <li>장례비(봉안시설비 제외) : 5백만원 미만시 최소 5백만원 공제. 1천만원 초과시 1천만원까지만 공제.</li>
                                <li>봉안시설, 자연장지에 사용된 금액 : 별도로 5백만원을 한도로 공제.</li>
                                <li> 합계 1천5백만원까지 한도  </li>
                            </ul>
                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(6)">뒤로가기</button>
                                <button onclick="nextStep(8)">다음</button>
                            </div>
                        </div>

                    </div>


                    <div id="step8" style="display: none;">
                        <h2>사전증여재산</h2>
                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;"></div>
                        <strong>10년내 배우자  증여  금액  :</strong> <input type="text" id="giftFromMother" inputmode="numeric" oninput="formatNumber(this)" > 
                        <strong>10년내  자녀 증여 증여 금액 :</strong><input type="text" id="giftToChildren" inputmode="numeric" oninput="formatNumber(this)">
                        <strong>5년내 상속인 외 증여 금액 예) 손자 손녀 :</strong><input type="text" id="giftToOthers" inputmode="numeric" oninput="formatNumber(this)">
                        <strong>위 증여시 산출된 증여세 합계 :</strong> <input type="text" id="giftTaxDeduction" inputmode="numeric" oninput="formatNumber(this)" >


                        <div style="display: flex; justify-content:left ; gap: 20px;">
                            <button class="col-btn" onclick="previousStep(7)">뒤로가기</button>
                            <button onclick="nextStep(9)">다음</button>
                        </div>
                    </div>


                    <div id="step9" style="display: none;">
                        <h2>상속공제</h2>
                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
                            <input type="number" id="inheritanceDeduction" name="상속공제" value="1000000000" readonly="">
                            <ul>
                                <li>배우자가 생존해 있는 경우 최소 10억원.</li>
                                <li>사전증여가 많은 경우 10억이 안될수 있음.</li>
                                <li>그외 금융상속공제, 동거주택상속공제 등이 있음.</li>

                            </ul>
                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(8)">뒤로가기</button>
                                <button onclick="nextStep(10)">다음</button>
                            </div>
                        </div>



                    </div>


                    <div id="step10" style="display: none;">
                        <h2>감정평가수수료</h2>
                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
                            <input type="text" id="appraisalFee" inputmode="numeric" oninput="formatNumber(this)">
                            <ul>
                                <li>5백만원 한도</li>
                            </ul>
                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(9)">뒤로가기</button>
                                <button onclick="nextStep(11); calculateInheritanceTax(parseInt(document.getElementById('inheritanceDeduction').value));">상속세계산</button>
                            </div>
                        </div>

                    </div>


                    <div id="step11" style="display: none;">



                        <h2>상속세 계산 결과</h2>
                        <table border="1" id="resultTable">
                            <thead>
                            <tr>
                                <th>구분</th>
                                <th>금액</th>
                                <th>비고</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td id="totalPropertyValue">(1) 총상속재산가액</td>
                                <td id="totalPropertyValueCell" style="text-align: right;">5,147,006</td>
                                <td style="text-align: center;">상속재산 총합 </td>
                            </tr>

                            <tr>
                                <td>(2) 채무 및 공과금</td>
                                <td id="debtsValueCell" style="text-align: right;">343,425</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>(3) 장례비용 </td>
                                <td id="funeralExpenseValueCell" style="text-align: right;">5,000,000</td>
                                <td style="text-align: center;">최소 5백공제. 최대 1천5백 한도.</td>
                            </tr>
                            <tr>
                                <td>(4) 사전증여재산</td>
                                <td id="priorGiftsValueCell" style="text-align: right;">1,049,169</td>
                                <td style="text-align: center;"></td>
                            </tr>

                            <tr>
                                <td>(5) 상속세 과세가액</td>
                                <td id="taxableAmountValueCell" style="text-align: right;">852,750</td>
                                <td style="text-align: center;">(1) - (2) + (3)</td>
                            </tr>
                            <tr>
                                <td>(6) 상속공제</td>
                                <td id="inheritanceDeductionValueCell" style="text-align: right;">1,000,000,000</td>
                                <td style="text-align: center;">배우자 생존시 최소 10억</td>
                            </tr>
                            <tr>
                                <td>(7) 감정평가수수료</td>
                                <td id="appraisalFeeValueCell" style="text-align: right;">0</td>
                                <td style="text-align: center;"> 5백만 원 한도</td>
                            </tr>
                            <tr>
                                <td>(8) 상속세 과세표준</td>
                                <td id="taxBaseValueCell" style="text-align: right;">0</td>
                                <td style="text-align: center;">(4) - (5) - (6)</td>
                            </tr>
                            <tr>
                                <td>(9) 세율</td>
                                <td id="taxRateValueCell" style="text-align: right;">10%~50%</td>
                                <td style="text-align: center;">누진세율</td>
                            </tr>
                            <tr>
                                <td>(10) 산출세액</td>
                                <td id="calculatedTaxValueCell" style="text-align: right;">0</td>
                                <td style="text-align: center;">(7) × (8)</td>
                            </tr>
                            <tr>
                                <td>(11) 세액공제</td>
                                <td id="taxDeductionValueCell" style="text-align: right;">5,079,342</td>
                                <td style="text-align: center;">증여세액공제 + 신고세액공제 3%</td>
                            </tr>
                            <tr>
                                <td>(12) 자진납부할세액</td>
                                <td id="payableTaxValueCell" style="text-align: right;">0</td>
                                <td style="text-align: center;">(9) - (10)</td>
                            </tr>
                            </tbody>
                        </table> <br><br>



                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">

                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(10)">뒤로가기</button>
                                <button onclick="nextStep(12);"> 세금 줄이기 !</button>
                            </div>
                        </div>




                    </div>

                    <div id="step12" style="display: none;">
                        <div class="no-print">
                            <section class="inheritance-tax-guide">
                                <h2>상속세 신고시 반드시 알아야 할 절세 목록</h2>
                                
                                <div class="tax-tips">
                                <div class="tip" data-target="step13">상속세 ! 확실히 줄일 수 있습니다.</div>
                                <div class="tip" data-target="step14">취득세! 70% 까지 줄일 수 있습니다.</div>
                                <div class="tip" data-target="step15">종부세 ! 피할수 있습니다.</div>
                                <div class="tip" data-target="step16">상속 받은 주택과 농지, 임야 매도할때 ! 세금 " 0 " 만들수 있습니다.</div>
                                <div class="tip" data-target="step17">상속 받은 주택 외 가지고 있던 주택 양도시 ! 1세대 1주택 비과세 만들수 있습니다.</div>
                                <div class="tip" data-target="step18">주택 상속으로 2주택인 경우, 청약기회 사라진 건 아닐까요 ?</div>
                                <div class="tip" data-target="step19">부모님 기초연금 받게 할 순 없을까요 ?</div>
                                </div>
                            
                                <h3>뒤로 가기</h3>
                                <div class="back-links">
                                <div class="back-link" data-target="step1"> 주택가격</div>                                <div class="back-link" data-target="step2">비주거용건물(대지 포함)</div>
                                <div class="back-link" data-target="step3">농지</div>
                                <div class="back-link" data-target="step4">임야(산)</div>
                                <div class="back-link" data-target="step5">금융자산 등 그외상속재산</div>
                                <div class="back-link" data-target="step6">채무 및 공과금</div>
                                <div class="back-link" data-target="step7">장례비용</div>
                                <div class="back-link" data-target="step8">사전증여재산</div>
                                <div class="back-link" data-target="step9">상속공제</div>
                                <div class="back-link" data-target="step10">감정평가수수료</div>
                                <div class="back-link" data-target="step11">상속세 계산 결과</div>
                                </div>
                            </section>

                        </div>
                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">

                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(11);">뒤로가기</button>
                                <button onclick="nextStep(13);">상속세 줄이러 가기</button>

                            </div>
                        </div>


                    </div>

                    <div id="step13" style="display: none;">

                        <h2> 상속세 절세 방법 </h2>

                        <h2>▶ 배우자상속공제 한도까지 최대로 받기!</h2>

                        <h4>상속인이 되는 자녀수</h4>
                            <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
                                <input type="number" id="childrensNumber" placeholder="자녀  명 ">                               
                        
                            </div>                         
                                                    <p> <strong>배우자 상속공제 한도 </strong> </p>

                        <button onclick="calculateSpouseInheritanceDeduction()">배우자 상속공제 한도 </button> <br><br>


                        <table border="1">
                            <thead>
                            <tr>
                                <th>구분</th>
                                <th>금액</th>
                                <th>비고 </th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>배우자 상속공제 한도</td>
                                <td id="spouseInheritanceDeductionCell" style="text-align: right;"></td>
                                <td style="text-align: center;"> 한도 </td>
                            </tr>
                            </tbody>
                        </table>
                        <br><br>
                        
                        <details>
                            <summary>배우자공제 받으면서 반드시 해야 할 일</summary>
                            <ul>
                                <li>배우자상속공제를 높이면 5억원 이상 공제를 받을 수 있습니다. 배우자 공제는 30억까지 가능한데 다만, 실제 상속받은 금액과 법정상속분을 한도로 하고 있습니다.</li>
                                <li>상속세 조사과정에서 배우자에게 사전 증여한 것이 있다면, 한도가 줄어들 수 있어 법정상속분보다 좀 더 상속받은 것이 좋습니다.</li>
                                <li>배우자 상속공제는 상속세과세표준신고기한의 다음날부터 9개월이 되는 날까지 배우자 몫으로 상속재산을 분할한 경우에 적용합니다. 이때 등기 등록이 필요한 부동산 등이 있는 경우는 <strong>반드시 등기 등록을 해야 합니다.</strong></li>
                                <li>상속인은 상속재산의 분할사실을 <strong>상속세과세표준신고기한의 다음날부터 9개월이 되는 날까지 납세지 관할세무서장에게 반드시 신고해야 합니다.</strong></li>
                            </ul>
                        </details>
                    
                        <details>
                            <summary>배우자상속공제 한도 계산</summary>
                            <p>배우자상속공제 한도 = max [ min (1, 2, 3), 5억원 ]</p>
                            <ol>
                                <li>거주자의 사망으로 상속이 개시되어 배우자가 실제 상속받은 금액</li>
                                <li>(상속재산가액* × 배우자의 법정상속분) - 상속재산에 가산한 배우자가 사전증여받은 재산의 증여세 과세표준 ( = 사전증여재산 - 6억)</li>
                                <li>30억원</li>
                            </ol>
                            <p>* 상속재산가액 = (본래+간주+추정)상속재산가액 + 사망일 전 10년 이내 상속인에게 증여한 재산가액 - 상속인이 아닌 수유자가 유증·사인증여 받은 재산가액 - 비과세 재산가액 - 공과금 및 채무 - 과세가액 불산입 재산가액</p>
                        </details>
                    
                        <details>
                            <summary>배우자의 실제 상속받은 금액 계산</summary>
                            <p><strong>배우자상속공제를 최대로 높이기 위해서 배우자가 상속받아야 할 순상속재산</strong> 은 다음과 같습니다:</p>
                            <table border="1">
                                <tr>
                                    <td>
                                        <ul>
                                            <li>배우자가 상속받은 상속재산가액(사전증여재산가액 및 추정상속재산가액 제외)</li>
                                            <li>(-) 배우자가 승계하기로 한 공과금 및 채무액</li>
                                            <li>(-) 배우자 상속재산 중 비과세 재산가액</li>
                                            <li>(-) 배우자 상속재산 중 과세가액 불산입액</li>
                                            <li>(=) 배우자가 실제 상속받은 금액</li>
                                        </ul>
                                    </td>
                                </tr>
                            </table>
                        </details>

                        <h2>▶ 동거주택상속공제를 받기 !  </h2>

                        <li><a href="https://tuzaga.com/%eb%8b%b9%ec%8b%a0%ec%9d%98-%ec%84%b8%eb%ac%b4%ec%82%ac-%eb%b8%94%eb%a1%9c%ea%b7%b8-%eb%8f%99%ea%b1%b0%ec%a3%bc%ed%83%9d%ec%83%81%ec%86%8d%ea%b3%b5%ec%a0%9c%ec%9d%98-%eb%aa%a8%eb%93%a0-%ea%b2%83/" target="_blank">동거주택상속공제 상세</a> </li>

                        <div class="container">                            
                            
                            <button onclick="openCohabitationModal()">동거상속공제 계산</button>
                            
                            <div id="cohabitationModal" class="modal">
                                <div class="modal-content">
                                    <span class="close" onclick="closeCohabitationModal()">&times;</span>
                                    <h2>동거상속공제 계산</h2>
                                    동거주택가격의 100%를 공제합니다 , 다만 6억 한도을 한도로 하며, 다음 요건을 모두 충족해야 합니다.
                                    <ul>
                                        <li>사망일 전 부터 10년이상 계속 같이 하나의 주택에서 거주할것</li>
                                        <li>동거한 자녀가 상속받을 것</li>
                                        
                                    </ul>

                                    <input type="checkbox" id="notApplicableCheckbox" onchange="calculateCohabitationDeduction()">
                                    <label for="notApplicableCheckbox">해당없음</label>

                                    <p><strong>주택 가격: <span id="modalHouseValueCell"></span></strong></p>
                                    <label for="houseDebt">주택이 담보하는 채무가액:</label>
                                    <input type="text" id="houseDebt" oninput="formatNumber(this)" placeholder="채무가액을 입력하세요">
                                    <button onclick="calculateCohabitationDeduction()">계산</button>
                                    <p>동거상속공제액: <span id="cohabitationDeduction"></span></p>
                                    <button onclick="applyCohabitationDeduction()">적용</button>
                                </div>
                            </div>
                    
                            <div id="resultSection">
                              
                                <p><strong>동거상속공제액: <span id="cohabitationDeductionAmount">0</span></strong></p>
                            </div>
                        </div>



                        <h2> ▶ 금융재산상속공제
                    를 받아요!  </h2>
                        <li><a href= "https://tuzaga.com/%ea%b8%88%ec%9c%b5%ec%9e%ac%ec%82%b0-%ec%83%81%ec%86%8d%ea%b3%b5%ec%a0%9c-2/" target="_blank">금융재산상속공제 상세</a> </li>   
                        
                        <div class="container">
                           
                            <button onclick="openFinancialModal()">금융재산 공제 계산</button>
                    
                            <div id="financialModal" class="modal">
                                <div class="modal-content">
                                    <span class="close" onclick="closeFinancialModal()">&times;</span>
                                    <h2>금융재산 공제 계산</h2>
                                    <p>순금융재산액( 금융재산-금융채무 )에서 다음과 같이 공제</p>
                                    <ul>
                                        <li>순금융재산액 2천만원 초과 : 순금융재산 가액의 20% 혹은 2천만원 중 더 큰 금액이 공제, 최대 2억원 한도.</li>
                                        <li>순금융재산액 2천만원 이하 : 순금융재산의 전액 공제 .</li>
                                        
                                    </ul>
                                    <label for="financialAssets">금융재산:</label>
                                    <input type="text" id="financialAssets" oninput="formatNumber(this)" ><br>
                                    <label for="financialDebts">금융채무:</label>
                                    <input type="text" id="financialDebts" oninput="formatNumber(this)" >
                                    <button onclick="calculateFinancialDeduction()">계산</button>
                                    <p>공제액: <span id="financialDeductionResult"></span></p>
                                    <button onclick="applyFinancialDeduction()">적용</button>
                                </div>
                            </div>
                    
                            <div id="resultSection">
                               
                                <p><strong>금융재산 공제액: <span id="finalFinancialDeductionAmount">0</span></strong></p>
                            </div>
                        </div>
                    
                            <h2> ▶ 일괄공제 5억보다 클수 있어요 !</h2>
                            <div class="container">
                            
                                <button onclick="openInheritanceModal()">인적공제 계산</button>
                        
                                <div id="inheritanceModal" class="modal">
                                    <div class="modal-content">
                                        <span class="close" onclick="closeInheritanceModal()">&times;</span>
                                        <h2>기초+인적공제 계산</h2>
                                        <form id="deductionForm">
                                            <label for="children">자녀 수:</label>
                                            <input type="number" id="children" min="0" required>
                                            
                                            <label for="minors">상속인 및 동거가족 중 미성년자 명:</label>
                                            <input type="number" id="minors" min="0" required>
                                            
                                            <label for="minorYears">미성년자의 19세까지 남은 연 수를 (모든 미성년자의 합):</label>
                                            <input type="number" id="minorYears" min="0" required>
                                            
                                            <label for="seniors">상속인 및 동거가족 중 65세 이상자 명 :</label>
                                            <input type="number" id="seniors" min="0" required>
                                            
                                            <button type="submit">계산하기</button>
                                        </form><br>
                                        <div id="deductionResult"></div>    
                                        <button id="applyButton" onclick="applyDeduction()">적용</button>            
                                    </div>
                                    
                                </div>
                        
                                <div id="resultSection">
                                   
                                    <p><strong>max (기초 + 인적공제 , 일괄공제 ) 금액 : <span id="finalDeductionAmount">0</span>원</p>
                                </div>
                            </div> <br>

                        <div class="container">    
                            <h2> ⏹ 총 상속공제 합계 </h2>
                            <p><strong> 합계: <span id="totalDeductionResult">0</span></strong></p>    
                        </div><br

                      <h2>▶ 상속공제에 따른 비교 </h2>


                        <label for="inheritanceDeduction1">상속공제가 10억일 경우( 일괄공제 5억 + 배우자공제 5억)</label><br>
                        <input type="number" id="inheritanceDeduction1" name="상속공제" value="1000000000" readonly=""><br><br>

                        

                        <label for="inheritanceDeduction2">상속공제 모두 받을경우 상속공제 합계액:</label><br>                       
                        <input type="text" id="inheritanceDeduction2" readonly>

                        <br>

                        <button onclick="performDeductionComparison()">계산</button>

                        <div id="result"></div> <br>


                        <h2>▶ 평가액을 높혀 향후 양도세를 줄여요 !</h2>

                        <details>
                            <summary>취득가를 높이세요 !!</summary>
                            <ul>
                                <li>주택, 빌딩, 그 외 자산의 가치가 10억원 미만인 경우, 상속 주택을 가능한 한 높게 평가하여 상속세 신고를 하는 것이
                                    양도소득세를 절감하는 데 도움이 됩니다. 상속세 신고 시 평가된 가액이 양도세의 취득가액으로 적용되기 때문입니다.
                                    아파트와 달리 단독주택 등 매매 사례가 없는 경우에는 감정평가를 통해 신고할 수 있습니다. </li>
                                <li>상속 재산의 가치가 10억원을 초과하는 경우에도, 상속세와 양도세를 비교하여 양도세 절감 효과가 크다면,
                                    감정평가 등을 통해 시가로 신고하는 것을 고려해야 합니다.</li>
                            </ul>
                        </details><br><br>                      







                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">

                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(12); ">뒤로가기</button>
                                <button class="clickable" data-target="step12" style="padding: 5px 10px;">목록</button>
                                <button onclick="nextStep(14); "> 취득세 줄이러 가기</button>

                            </div>
                        </div>


                    </div>

                    <div id="step14" style="display: none;">   <!--취득세--------------------------------------------------->
                        <h2>◈ 배우자와 자녀의 취득세는 얼마일까요 ?</h2>

                        <ul>
                            <li>아버지 사망일로부터 6개월이 속하는 달의 말일까지 취득세를 신고하고 납부해야 합니다.</li>
                            <li>취득세의 과세표준은  시가로 계산하지 않고 모두 시가표준액으로 계산합니다.
                                주택는 공시가격, 농지와 임야는 개별공시지가, 건물은 시가표준액으로 계산합니다.</li>
                            
                        </ul>
                        

                        <h3> 내가 받은 주택 또는 건물 또는 임야 농지의 취득세 </h3>




                        <label for="houseValueAc">주택 공시가격(원):</label> <br>
                        <input type="text" id="houseValue1" inputmode="numeric" oninput="formatNumber(this)"><br>

                        <label for="houseType">주택 규모:</label><br>
                        <select id="houseType" style="font-size: 12px; padding: 8px; width: 400px;">
                            <option value="small">국민주택규모 이하</option>
                            <option value="big">국민주택규모 초과</option>
                        </select><br><br>


                        <label for="buildingValue1">건물 공시가격(원):</label><br>
                        <input type="text" id="buildingValue1" inputmode="numeric" oninput="formatNumber(this)"><br>



                        <label for="landValue">임야 공시가격(원):</label><br>
                        <input type="text" id="landValue" inputmode="numeric" oninput="formatNumber(this)"><br>


                        <label for="farmlandValue">농지 공시가격(원):</label><br>
                        <input type="text" id="farmlandValue" inputmode="numeric" oninput="formatNumber(this)"><br>

                        <button onclick="calculateInheritAcquisionTax()">취득세 계산</button>

                        <h3>계산 결과</h3>
                        <table>
                            <tbody><tr>
                                <th>구분</th>
                                <th style="text-align: center;">취득세</th>
                                <th style="text-align: center;">농어촌특별세</th>
                                <th style="text-align: center;">지방교육세</th>
                                <th style="text-align: left;">합계</th>
                            </tr>
                            <tr>
                                <td>주택</td>
                                <td style="text-align: center;"><span id="houseAcquisitionTax"></span></td>
                                <td style="text-align: center;"><span id="houseAgtax"></span></td>
                                <td style="text-align: center;"><span id="houseEduTax"></span></td>
                                <td style="text-align: left;"><span id="houseTotalTax"></span></td>
                            </tr>
                            <tr>
                                <td>건물</td>
                                <td style="text-align: center;"><span id="buildingAcquisitionTax"></span></td>
                                <td style="text-align: center;"><span id="buildingAgtax"></span></td>
                                <td style="text-align: center;"><span id="buildingEduTax"></span></td>
                                <td style="text-align: left;"><span id="buildingTotalTax"></span></td>
                            </tr>
                            <tr>
                                <td>임야</td>
                                <td style="text-align: center;"><span id="landAcquisitionTax"></span></td>
                                <td style="text-align: center;"><span id="landAgtax"></span></td>
                                <td style="text-align: center;"><span id="landEduTax"></span></td>
                                <td style="text-align: left;"><span id="landTotalTax"></span></td>
                            </tr>
                            <tr>
                                <td>농지</td>
                                <td style="text-align: center;"><span id="farmlandAcquisitionTax"></span></td>
                                <td style="text-align: center;"><span id="farmlandAgtax"></span></td>
                                <td style="text-align: center;"><span id="farmlandEduTax"></span></td>
                                <td style="text-align: left;"><span id="farmlandTotalTax"></span></td>
                            </tr>
                            <tr>
                                <td>합계</td>
                                <td style="text-align: center;"><span id="totalAcquisitionTax"></span></td>
                                <td style="text-align: center;"><span id="totalAgtax"></span></td>
                                <td style="text-align: center;"><span id="totalEduTax"></span></td>
                                <td style="text-align: left;"><span id="totalTax"></span></td>
                            </tr>
                            </tbody></table>


                        <h2>◈ 주택관련 취득세 절세 방법이 있습니다.</h2>
                        
                        <details>
                            <summary>1)상속세 특례세율을 이용합니다.</summary>
                        <ul>
                            <li>상속으로 주택을 취득한 경우 취득세는 2.8%입니다.</li>
                            <li>무주택세대주가 상속으로 인하여 1세대 1주택이 된 경우에는 취득세는 0.8%로 2%를 빼줍니다. </li>
                            <li>1주택을 공동으로 상속받는 경우, 공동상속받은 사람 모두를 공제해 주지 않고,  지분이 가장 큰 사람 1인만 공제 해줍니다. ,
                                지분이 동일한 경우 거주하는 사람, 같이 거주했으면 연장자만 공제 해줍니다. </li>
                            <li> 예)  아버지가 돌아가셔서 아버지 소유주택 1개를  어머니와 아들이 50%씩 상속받았음.  돌아가시기 전 어머니와 자녀는  같이  그 집에 거주하고 있었고,  그때 당시 어머니와 자녀 모두 다른 소유주택은 없는 경우    :   한사람만 공제가 되는데 ,  판단순서는  먼저 지분으로 판단, 50% 로 동일하기 때문에 , 다음으로 상속당시 거주하는 사람,  둘다 거주하고 있었기 때문에 ,  그 다음은 연장자 순 ,  따라서 어머니만 0.8% 취득세율을 적용하고 아들은 2.8% 를 내야 함.  </li>
                        </ul>
                        </details>

                        <details>
                            <summary>2) 사망일전에 세대분리를 분리하여 무주택세대를 만듭니다. </summary><br>
                        
                        <ul>
                            <li>상속받을 세대는 무주택세대가 받아야 특례를 받을수 있습니다. </li>
                            <li>어머니가 상속받는 경우, 주택이 있는 자녀가 주민등록표상에 같이 있다면 세대분리를 하는 것이 좋습니다.</li>
                            <li>무주택 자녀가 상속받는 경우, 같이 사는 30세 이상인 세대원이 주택을 소유하고 있다면
                                그 세대원을 세대분리 해야 합니다. </li>
                            <li>즉, 주택상속받을 사람을 사망일 전에 무주택자로 만드는 것입니다. </li>
                        </ul>
                        </details><br><br>
                        

                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">

                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(13); ">뒤로가기</button>
                                <button class="clickable" data-target="step12" style="padding: 5px 10px;">목록</button>
                                <button onclick="nextStep(15); "> 종부세 줄이러 가기 </button>

                            </div>
                        </div>

                    </div>

                    <div id="step15" style="display: none;">  <!---종부세절세하기----------------------------------------------------->
                        

                        <h2>◈ 종부세 절세 방법이 있을까요? </h2>
                        <h4>1) 상속주택 특례를 이용합니다.</h4>
                        <p>상속받은 주택도 종부세 과세합니다. 다만, 1세대 1주택자가 상속으로 인하여 2주택(공동상속지분 포함)이 되는 경우라도 다음 어느
                            하나에 해당하는 경우 1세대 1주택으로 보고 12억공제, 보유기간별, 연령별세액공제를 적용받을 수 있습니다.
                            또한, 중과세율 적용시 주택수 판단할 때 상속주택은 없는 것으로 보고 세율적용을 합니다.</p>
                        <ul>
                            <li>상속일로부터 5년 이내</li>
                            <li>공동상속의 경우 40% 이하의 소수지분</li>
                            <li>소수지분이 기준시가 6억원 이하(수도권 밖 3억원 이하)</li>
                        </ul>



                        <h4>2) 일부지분을 줄여 요건에 맞게 할수 있습니다.</h4>
                        <p>시간이 지남에 따라서 소수지분이 기준시가가 처음엔 6억원이하 였다가,  6억원이 넘는 경우가 있을 수 있습니다. 이런 경우
                            일부지분을 증여 또는 양도를 통해서 6억이하로 만들어 종부세를 줄일 수 있습니다.</p>




                        <h2>◈ 나의 재산세와 종부세를 계산해 볼까요 ?</h2>                       


                        <h3>상속 후 재산세 비교</h3>
                        <label for="owned_houses">상속 전 나의 소유주택 수:</label><br>
                        <input type="text" id="owned_houses" inputmode="numeric" oninput="formatNumber(this)" placeholder=" ">

                        <br>
                        <label for="gongsi_1">상속전 나의 주택공시가 합 :</label><br>
                        <input type="text" id="gongsi_1" inputmode="numeric" oninput="formatNumber(this)" placeholder=" ">
                        <br>
                        <label for="ownedHousesAfter">상속 후 나의 소유주택 수:</label><br>
                        <input type="text" id="ownedHousesAfter" inputmode="numeric" oninput="formatNumber(this)" placeholder=" 지분으로 소유하고 있는 주택 포함">
                        <br>
                        <label for="gongsi_2">상속주택분 공시가격:</label><br>
                        <input type="text" id="gongsi_2" inputmode="numeric" oninput="formatNumber(this)" placeholder=" ">
                        <br>
                        <button onclick="comparePropertyTax()">재산세 비교 계산하기</button>
                        <P> 계산결과 :</P>
                        <table id="resultTableProperty" style="display: none;">
                            <thead>
                            <tr>
                                <th>구분</th>
                                <th>종전주택만 있는 경우</th>
                                <th>상속주택 추가된 경우</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>재산세</td>
                                <td id="property_tax_1"></td>
                                <td id="property_tax_2"></td>
                            </tr>
                            <tr>
                                <td>도시계획세</td>
                                <td id="dosi_tax_1"></td>
                                <td id="dosi_tax_2"></td>
                            </tr>
                            <tr>
                                <td>지방교육세</td>
                                <td id="p_edu_tax_1"></td>
                                <td id="p_edu_tax_2"></td>
                            </tr>
                            <tr>
                                <td>총 세금</td>
                                <td id="total_tax_1"></td>
                                <td id="total_tax_2"></td>
                            </tr>
                            </tbody>
                        </table>
                        

                        <h3>상속후 종부세비교하기</h3>


                        <label for="age">상속받는 나의 연령(만):</label><br>
                        <input type="text" id="age" inputmode="numeric" placeholder="상속받는 나의 연령(만)">
                        <br>
                        <label for="period">상속전 나의 주택 보유기간(년):</label><br>
                        <input type="text" id="period" inputmode="numeric" placeholder="상속전 내가 보유한 주택의 보유기간(만)">

                        <br>
                        <button onclick="compareComprehensiveTax()">종부세 비교 계산하기</button>
                        <P> 계산결과 :</P>
                        <div id="resultComprehensiveTax"></div>




                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">

                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(14); ">뒤로가기</button>
                                <button class="clickable" data-target="step12" style="padding: 5px 10px;">목록</button>
                                <button onclick="nextStep(16); "> 상속부동산 양도세 줄이기</button>

                            </div>
                        </div>

                    </div>

                    <div id="step16" style="display: none;"> <!--상속부동산 양도---------------------------------------------------------->
                        <h2>◈ 상속받은 부동산을 매도하는 경우 양도세는 어떻게 되나요 ? </h2>
                        <details>   
                            <summary>반드시 ! 상속세뿐만 아니라 양도세까지 검토하여 부동산을 평가해야  </summary>
                           
                        <ul>
                            <li><p>상속받은 부동산의 취득가격은 상속세 신고시 시가로 평가하여 신고한 가액입니다.</p> </li>
                            <li><p>상속부동산의 시가평가는 사망일 전후 6개월이내의 이 상속주택의 매매가액,감정가액 또는 이 상속주택과 유사한 매매사례가액순으로 시가로
                                    평가하여 신고하도록 되어 있습니다.</p> </li>

                            <li><p>상속세 신고는 사망일이 속한 달의 말일 부터 6월이 되는날까지 신고하게 되어 있습니다. 신고 기한까지 타인에게 매매 계약을 체결한 경우는
                                    매매가액이 취득가액이 됩니다. 따라서 이러한 경우 취득가액과 양도가액이 동일하여 양도세가 없습니다.</p> </li>

                            <li><p>상속세를 신고하지 않으면, 취득가액이  기준시가로 결정되는 경우도 있고, 취득가액 자체를 결정하지 않는 경우도 많습니다.
                                    이렇게 되면, 사망일 당시의 시가를 취득가액으로 인정받을 수 없어 향후 양도시 양도세를 많이 납부하게 됩니다. </p> </li>

                            <li><p>사망일 당시 시가를 다시 인정받으려면, 기한후 신고를 해서 세무서로부터 조사결정을 받아야 하거나,
                                    그래도 받아 들이지 않으면 조세불복등 아주 어려운 과정을 거쳐 취득가액을  인정받아야 합니다.  제척기간이 지난 경우는 아예 그 당시 시가가 명백하더라도
                                    시가를 인정받을 수 없습니다.  </p>  </li>

                            <li><p>따라서 상속세뿐만 아니라 양도세까지 검토하여 상속세가 나오지 않는다 하더라도 신고하는것이 좋습니다. </p></li>

                        </ul>
                        </details>

                        <h4>▶ 양도세 시뮬레이션 : 매도시기와 취득가액를 고려하여 경우마다 각각의 사례를 볼까요 ?</h4>

                        
    <p> 상속인이 농사짓지 않는 "비사업용 토지"는 사망일로부터 5년 이후 양도하는 경우 기본세율에  10% 추가합니다.</p>
    <p>※ 보유기간 : 사망일 ~ 양도일 (만, 년)</p>
    
    <div id="calculator-1" class="calculator-section">
        <h2>1) 6개월 이내 양도시</h2>
        <p>※ 양도가액과 취득가액이 동일하여 양도차익이 없습니다. 감정을 받을 필요없습니다.</p>
        <label for="transferPrice1">양도가액:</label>
        <input type="text" id="transferPrice1" inputmode="numeric" oninput="formatNumber(this)"><br>
       <label for="acquisitionPrice1">취득가액(=양도가액):</label>
        <input type="text" id="acquisitionPrice1" readonly><br>
    </div>

    <div id="calculator-2" class="calculator-section">
        <h2>2) 시가 신고후 미래 양도시</h2>
        <p>※ 상속세 신고후 몇년이 지난후를 예상한 경우입니다.</p>
        <p>※ 상속세 신고한 가격이 취득가액이 됩니다.</p>
        
        <label for="transferPrice2">양도가액:</label>
        <input type="text" id="transferPrice2" inputmode="numeric" oninput="formatNumber(this); syncTransferPrice();"><br>
        <label for="acquisitionPrice2">취득가액(상속세신고시 신고한 가액) : </label>
        <input type="text" id="acquisitionPrice2" inputmode="numeric" oninput="formatNumber(this)"><br>
        <label for="holdingPeriod2">보유기간(년):</label>
        <input type="number" id="holdingPeriod2" step="0.1" min="0" oninput="syncHoldingPeriod();"><br>
        <label for="nonBusinessUse2">비사업용 여부(5년이내 항상 사업용으로 봄):</label>
        <input type="checkbox" id="nonBusinessUse2" onchange="syncNonBusinessUse();"><br>
    </div>

    <div id="calculator-3" class="calculator-section">
        <h2>3) 기준시가 신고후 미래 양도시</h2>
        <p>※ 기준시가로 신고하거나 무신고한 경우 경우입니다.</p>
        <p>※ 취득가액이 기준시가가 됩니다. </p>
        <label for="transferPrice3">양도가액:</label>
        <input type="text" id="transferPrice3" inputmode="numeric" readonly><br>
        <label for="acquisitionPrice3">취득가액(상속당시 기준시가): </label>
        <input type="text" id="acquisitionPrice3" inputmode="numeric" oninput="formatNumber(this)"><br>
        <label for="holdingPeriod3">보유기간(년): </label>
        <input type="number" id="holdingPeriod3" step="0.1" min="0" readonly><br>
        <label for="nonBusinessUse3">비사업용 여부(5년이내 항상 사업용으로 봄):</label>
        <input type="checkbox" id="nonBusinessUse3" disabled><br>
    </div>

    <button onclick="calculateAllTaxes()">모두 계산하기</button>

    <div id="resultTableTrance" style="display:none;"></div>
                        <br><br>

                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">

                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(15); ">뒤로가기</button>
                                <button class="clickable" data-target="step12" style="padding: 5px 10px;">목록</button>
                                <button onclick="nextStep(17); "> 일반주택 양도시 1세대 1주택 만들기 </button>

                            </div>
                        </div>

                    </div>

                    <div id="step17" style="display: none;">  <!--일반주택 양도시 1세대 1주택--------------------------------------------->
                        <h2>◈ 주택을 상속받고 나서 종전 일반주택 양도하는 경우 비과세를 받을수 있나요 ?</h2>

                        <ul>

                            <li><p>상속받은 주택외에 상속받기 전부터 가지고 있던 일반주택을  양도하는 경우입니다.이 일반주택이 양도당시에  1세대1주택 비과세 요건을 만족한다면,
                                    상속주택을 가지고 있다고 하더라도 비과세에 해당합니다 </p></li>
                            <li><p>상속일 이후에 취득한 일반주택은 이러한 비과세를 받을 수 없습니다. </p></li>
                            <li><p>1주택을 여러 사람이 공동으로 소유한 경우 주택 수를 계산할 때 공동 소유자 각자가 그 주택을 소유한 것으로 봅니다.(소령154조의2)</p>
                                <p>그러나 상속으로 인해 1주택을 공동으로 상속받았다면, 이 공동상속주택은 일반주택 양도시 주택으로 보지 않습니다.
                                    다만, 다음의 경우 해당하는 사람은 공동상속 주택이라도 주택이라고 보고, 일반주택 양도시 과세 됩니다.</p></li>

                            <p>1.지분이 가장 많은 사람</p>
                            <p>2.지분이 모두 동일하다면 다음순서</p>
                            <ul>
                                <li> 가. 상속주택에 거주하고 있는 사람</li>
                                <li> 나. 상속인 중 최연장자</li>
                            </ul>





                        </ul>

                        <h3>▶ 남은 배우자(어머니 혹은 아버지) 경우</h3>
                        <table>
                            <tbody><tr>

                                <th>구  분</th>
                                <th>상속전 무주택</th>
                                <th>상속전 1주택소유</th>
                                <th>상속전 2주택소유</th>

                            </tr>
                            <tr>
                                <td>단독으로 상속받은 경우</td>
                                <td>해당없음(참고1.)</td>
                                <td>과세 (참고2.)  </td>
                                <td>과세 </td>


                            </tr>
                            <tr>
                                <td>최대지분으로 상속</td>
                                <td>상동</td>
                                <td>과세(참고2)</td>
                                <td>과세</td>


                            </tr>
                            <tr>
                                <td>동일지분으로 상속</td>
                                <td>상동</td>
                                <td>과세(참고2)</td>
                                <td>과세</td>


                            </tr>
                            <tr>
                                <td>소수지분으로 상속</td>
                                <td>상동</td>
                                <td>과세(참고2)</td>
                                <td>과세</td>


                            </tr>
                            </tbody></table>
                        <details>
                            <summary>참고1.</summary>
                            상속받은 주택외에 다른 주택이 없기 때문에 해당사항이 없습니다. 그런데 만일 어머니가 상속주택을 양도하는 경우는 어떨까요? <br>
                            이 경우는 어머니는 사망일 전부터 아버지와 1세대 1주택을 소유하고 있는
                            것으로 보아 사망일 전에 아버지가  2년이상 거주 및 보유 했다면 상속주택도 1세대 1주택 비과세에 해당합니다.
                        </details>
                        
                        <details>
                            <summary>참고2.</summary>
                            아버지가 1주택 소유하고 있고, 어머니가 또 1주택을 소유한 상태에서 아버지가 사망한 경우입니다.<br>
                            상속전 어머니와 아버지는 동일세대이고,  2주택을 소유한 것이 됩니다.<br>
                            이 특례는 아버지가 사망으로 인하여 부득이하게 주택을 소유한 경우로서 일반주택을 양도 할 때 비과세를 인정하는 것이지,
                            동일 세대원인 어머니가 상속받는 경우, 상속받은 주택으로 볼수 없어 과세합니다. [대법2009두9772]
                        </details>

                        

                        <h3>▶ 자녀의 경우</h3>
                        <table>
                            <tbody><tr>

                                <th>상속전 각 자녀 소유주택</th>
                                <th>상속전 무주택</th>
                                <th>상속전 1주택</th>
                                <th>상속전 2주택</th>

                            </tr>
                            <tr>
                                <td>단독으로 상속받은 경우</td>
                                <td>해당없음.</td>
                                <td>비과세</td>
                                <td>과세</td>


                            </tr>
                            <tr>
                                <td>최대지분으로 상속</td>
                                <td>상동</td>
                                <td>과세(참고1).</td>
                                <td>과세</td>


                            </tr>
                            <tr>
                                <td>동일지분으로 상속</td>
                                <td>상동</td>
                                <td>순위에 따라 다름(참고1)</td>
                                <td>과세</td>


                            </tr>
                            <tr>
                                <td>소수지분으로 상속</td>
                                <td>상동</td>
                                <td>비과세</td>
                                <td>과세</td>


                            </tr>
                            </tbody></table>

                            <details>
                                <summary>참고1.</summary>
                                1주택을 공동으로 상속받았다면, 이 공동상속주택은 일반주택 양도시 주택으로 보지 않습니다.
                            다만, 다음의 경우 해당하는 사람은 공동상속 주택이라도 주택이라고 보고, 일반주택 양도시 과세 됩니다.</p>
                                <ul>
                                    <p>1.지분이 가장 많은 사람</p>
                                    <p>2. 지분이 모두 동일하다면 다음순서</p>
                                    <ul>
                                        <li> 가. 상속주택에 거주하고 있는 사람</li>
                                        <li> 나. 상속인 중 최연장자</li>
                                </ul>
                            </details>

                     


                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">

                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(16); ">뒤로가기</button>
                                <button class="clickable" data-target="step12" style="padding: 5px 10px;">목록</button>
                                <button onclick="nextStep(18); "> 상속주택 때문에 주택청약 이상 없을까 ?  </button>

                            </div>
                        </div>

                    </div>

                    <div id="step18" style="display: none;"> <!------상속받은주택과 나의 주택청약----------------------------------------->
                        <h2>◈ 상속주택때문에 아파트 청약을 받을수 없나요 ? </h2>


                        <p>주택청약시 주택소유 여부를 판단할때,  주택을 단독 또는 공유지분으로 소유하고 있는 경우도 주택을 소유하고 있는 것으로 봅니다.
                            <br>그러나 다음의 상속주택은 없는 것으로 봅니다.</p>

                        <ol>
                            <li>상속으로 주택의 공유지분을 취득한 사실이 판명되어 사업주체로부터 부적격자로 통보받은날부터 <strong> 3개월 이내에 그 지분을 처분한 경우. </strong>
                                (공급규칙 53조1호)</li>

                            <li>도시지역이 아닌지역 또는 면의 행정구역(수도권은 제외)에 에 건축되어 있는 주택으로서  다음 각목의 어느 하나에 해당하는 주택의 소유자가 해당 주택건설지역에 거주<strong>(상속으로 주택을 취득한 경우에는 피상속인이 거주한 것을
                                    상속인이 거주한 것으로 본다) 하다가 다른 주택건설지역으로 이주한 경우 (공급규칙 53조2호) </strong><br><br>
                                <ul>
                                    <li>가. 사용승인 후 20년 이상 경과된 단독주택</li>
                                    <li>나. 85제곱미터 이하의 단독주택 </li>
                                    <li>다. 소유자의 「가족관계의 등록등에 관한 법률」에 따른 최초 등록기준지에 건축되어 있는 주택으로서 직계존속 또는 배우자로부터 상속등에 의하여 이전받은 단독주택</li>
                                </ul>
                            </li>
                        </ol>

                        <h3>위 내용을 구체적으로 살펴볼까요 ?</h3>

                        <details>
                            <summary>
                                Q : 단독으로 주택의 공유지분을 상속받은 경우도 가능한가요  ? 
                            </summary>
                            A : 적용가능합니다.
                            예) 주택의 공유지분을 10%를 소유하고 있는 부친의 사망으로 자녀가 그 공유지분 10%를 단독으로 상속받은 경우 해당 고유지분 처분시
                            처음부터 주택을 소유하지 않는 것으로 인정 가능 </p>
                        </details>

                                           

                        <details>
                            <summary>
                                Q : 증여로 공유지분을 소유하게 된 경우는 ?  
                            </summary>
                            A : 증여로 취득한 경우 주택을  소유한 것으로 보아 52조1호를 적용 할 수 없습니다.
                        </details>

                        <details>
                            <summary>
                                Q : 도시지역이란 ?
                            </summary>
                            A : 토지의 용도가 도시지역(주거 상업 공업 녹지)인 지역을 말하며, 도시지역 여부는 토지이용계획확인원을 통해 확인이 가능합니다. 
                        </details>
                        
                        <details>
                            <summary>
                                Q : 피상속인이 거주한 것 ?
                            </summary>
                            A : 피상속인이 거주하였던 주택을 상속받은 경우 상속인이 입주자모집공고일 현재 다른 주택건설지역에 거주하고 있다면
                            제 53조 제 2호의 “ 해당 주택의 소유자가 해당 주택건설지역에 거주하다가 다른 주택건설지역으로 이주한 경우”에 해당합니다.
                        </details>
                        

                        <details>
                            <summary>
                                Q : 사용승인후 20년 경과 ?
                            </summary>
                            A : 사용승인일은 건축물 대장을 통하여 확인하여야 하나 , 건축물 대장이 없는 경우 해당 지자체를 통해 건축일자를 확인하거나
                        등기부등본상의 소유권보존등기일을 사용승인일로 보아 기간을 계산하여야 할것으로 판단됩니다.
                        </details>
                        

                            <details>
                                <summary>
                                    Q : 85제곱미터 이하의 단독주택 면적 산정시 단독주택과 분리된 창고, 화장실 등의 면적도 포함되는지 ?
                                </summary>
                                A :  85제곱미터 이하의 면적은 주택법시행규칙 제 2조 1호에 따른 주거전용면적을 의미합니다.
                            따라서 면적산정시 주택과 분리된 창고 차고 및 화장실의 면적은 포함되지 않습니다. 
                            </details>
                        
                            <details>
                                <summary>
                                    Q : 단독주택이 아닌 공동주택도 53조2호의 적용이 가능한지 ? 
                                </summary>
                                A :  53조 2호의 가~다항은 모두 단독주택일 것을 요건으로 하고 있습니다. 따라서 공동주택은 제 53조 2호를 적용할수 없습니다.
                            </details>
                        

                        <details>
                            <summary>
                                Q : 53조2호의 다항의 상속등에 증여도 포함되는지 ?
                            </summary>
                            A : 상속등에 의하여 이전받은 단독주택은 상속의 경우에만 인정되고 있으며 증여는 포함되지 않습니다.
                        </details>
                        

                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">
                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(17); ">뒤로가기</button>
                                <button class="clickable" data-target="step12" style="padding: 5px 10px;">목록</button>
                                <button onclick="nextStep(19); "> 부모님 기초연금 받으려면 ?  </button>

                            </div>
                        </div>

                    </div>

                    <div id="step19" style="display: none;"> <!--노인연금     --------------------------------------------->
                        <h2>◈ 홀로 남은 배우자가 기초연금을 받기 위해서 재산과 소득이 얼마 이하여야 하나요 ?</h2>

                        <details>
                            <summary>기초연금 대상자</summary>
                            <h4> ▶ 대상자</h4>
                        <p>기초연금은 만 65세 이상이고, 대한민국 국적을 가지고 국내에 거주하며, 소득인정액일 일정한 금액 이하여야 합니다.</p>


                        <h4>▶ 소득인정액계산</h4>
                        <p> 매월 벌어들이는 소득과 소유하고 있는 재산을 소득으로 환산. <br>
                            즉, 소득평가액 + 재산의 소득환산액으로 계산합니다.</p>

                        <h4>▶ 소득평가액</h4>
                        <p>소득평가액 = {0.7 x (월근로수입 - 108만원)}(A) + 기타소득(B)</p>
                        <p>A: 일용근로소득, 공공일자리소득, 자활근로소득은 근로소득에서 제외됩니다.</p>
                        <p>B: 기타소득: 사업소득, 금융소득, 공적이전소득, 무료임차소득</p>

                        <h4>▶ 재산의 소득환산액</h4>
                        <p>재산의 월 소득환산액 = [{(일반재산 - 기본재산액) + (금융재산 - 2,000만원) - 부채} x 0.04 ÷ 12개월] + 고급자동차 및 회원권의 가액</p>
                        <p>고급자동차(3,000cc 이상 또는 4천만원 이상) 및 회원권은 그 가액을 그대로 적용합니다.</p>

                        <h4>▶ 지역별 기본재산액</h4>
                        <table>
                            <thead>
                            <tr>
                                <th>구분</th>
                                <th>공제액</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>대도시 (특별시, 광역시의 "구" 포함) 및 특례시 예) 서울 관악구, 부산 해운대구, 대구 달성군</td>
                                <td>1억 3,500만원</td>
                            </tr>
                            <tr>
                                <td>중소도시 (도의 '시', 세종특별자치시) 예) 경기 성남시, 경북 안동시, 충남 천안시</td>
                                <td>8,500만원</td>
                            </tr>
                            <tr>
                                <td>농어촌 (도의 '군') 예) 전남 고흥, 강원 영월, 충북 음성</td>
                                <td>7,250만원</td>
                            </tr>
                            </tbody>
                        </table>   <br>

                        </details>
                        
                       
                        <h2>소득인정액 계산해 보기 </h2>

                        <h4>▶ 소득평가액</h4>

                        <label for="monthlyWorkIncome">월근로소득:</label>
                        <ul>
                            <li>직장가입자의 보수 월액.</li>
                            <li>상시근로소득 : 3개월 이상 계속적으로 고용되어 월정액 급여를 지급 받는 자의 근로소득을 말함.</li>
                            <li>일용근로소득 : 3개월 미만, 건설공사 종사자, 하역(항만)작업 종사자는 제외</li>
                            <li>공공일자리 소득(노인일자리사업, 장애인일자리사업, 자활근로, 공공근로등)은 제외</li>
                        </ul>
                        <input type="text" id="monthlyWorkIncome" inputmode="numeric" oninput="formatNumber(this)" placeholder="보수 월액 " required=""><br>


                        <label for="monthlyBusinessIncome">월 사업소득: 수입- 경비</label>
                        <ul>
                            <li>임대소득포함</li>
                            <li>연사업소득/12</li>
                        </ul>

                        <input type="text" id="monthlyBusinessIncome" inputmode="numeric" oninput="formatNumber(this)" placeholder=" " required=""><br>


                        <label for="monthlyFinancialIncome">월 금융소득( 이자+배당):</label>
                        <ul>
                            <li>이자소득의 경우 소득에서 월 4만원 제외한 금액. 0보다 적은 경우 없는 것으로 함.</li>

                        </ul>
                        <input type="text" id="monthlyFinancialIncome" inputmode="numeric" oninput="formatNumber(this)" placeholder=" " required=""><br>


                        <label for="houseStandardPrice">자녀주택의 시가표준액:</label>
                        <ul>
                            <li>자녀주택에서 사는 경우를 말함 </li>
                            <li>무료임차소득 = 자녀주택의 시가표준액 * 지분율 * 0.0078 / 12 </li>
                        </ul>
                        <input type="text" id="houseStandardPrice" inputmode="numeric" oninput="formatNumber(this)" placeholder=" 시가표준액을 넣으세요" required=""><br>

                        <label for="shareRatio">지분율:</label>
                        <ul>
                            <li>자녀와 제3자가 공동하고 있는 경우 자녀의 지분율을 말함</li>
                        </ul>
                        <input type="number" id="shareRatio" step="0.1" min="0" max="1" value="1" placeholder="0부터 1 사이의 값을 입력하세요" required="">

                        <br>
                        <label for="monthlyPublicTransferIncome">월 공적이전소득:</label>
                        <ul>
                            <li>｢국민연금법｣, ｢공무원연금법｣, ｢공무원 재해보상법｣, ｢군인연금법｣, ｢군인재해보상법｣, ｢사립학교교직원연금법｣, ｢별정우체국법｣,
                                ｢국민연금과 직역연금의 연계에 관한 법률｣에 의한 연금 급여 등 법령에 의해 정기적으로 지급되는 연금등.
                            </li>
                            <li>일시금은 금융재산으로 산정</li>
                        </ul>
                        <input type="text" id="monthlyPublicTransferIncome" inputmode="numeric" oninput="formatNumber(this)" placeholder=" " required=""><br>

                        <h3>▶ 재산 소득 환산액</h3>

                        <label for="realEstate">부동산등:</label>
                        <ul>
                            <li>부동산. 분양권. 재건축입주권. </li>
                        </ul>
                        <input type="text" id="realEstate" inputmode="numeric" oninput="formatNumber(this)" placeholder=" " required=""><br>


                        <label for="leaseDeposit">임차보증금 * 0.95:</label>
                        <ul>
                            <li>임차보증금이 있는 경우 임차보증금의 95% 만 반영</li>
                        </ul>
                        <input type="text" id="leaseDeposit" inputmode="numeric" oninput="formatNumber(this)" placeholder=" " required=""><br>

                        <label for="financialProperty">금융재산:</label><br><br>
                        <input type="text" id="financialProperty" inputmode="numeric" oninput="formatNumber(this)" placeholder=" " required=""><br>


                        <label for="debt">부채:</label> <br><br>
                        <input type="text" id="debt" inputmode="numeric" oninput="formatNumber(this)" placeholder=" " required=""><br>

                        <label for="luxuryCarOver4000">4천만원 이상 고급자동차:</label>
                        <ul>
                            <li>보험개발원의 차량기준액으로 평가 ; <a href="https://www.kidi.or.kr/user/car/carprice.do" target="_blank">학인하러 가기</a> </li>
                        </ul>
                        <input type="text" id="luxuryCarOver4000" inputmode="numeric" oninput="formatNumber(this)" placeholder=" " required=""><br>

                        <label for="membershipRight">회원권:</label>
                        <ul>
                            <li>시가표준액으로 평가</li>
                        </ul>
                        <input type="text" id="membershipRight" inputmode="numeric" oninput="formatNumber(this)" placeholder=" " required=""><br>

                        <label for="region">지역:</label>
                        <ul>
                            <li>지역마다 일정액공제</li>
                        </ul>
                        <select id="region" style="font-size: 14px; padding: 10px; width: 400px;">
                            <option value="대도시">대도시(특별시･광역시의 ‘구’(도･농복합군 포함), 특례시)</option>
                            <option value="중소도시">중소도시(특별자치도･도의 ‘시’, 세종특별자치시)</option>
                            <option value="농어촌">농어촌(특별자치도･도의 ‘군’)</option>
                        </select><br>

                        <button onclick="calculateIncomeProperty()">계산하기</button>
                        <P>계산 : </P>

                        <div id="resultPention"></div>


                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">

                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(18); ">뒤로가기</button>
                                <button class="clickable" data-target="step12" style="padding: 5px 10px;">목록</button>
                                <button onclick="nextStep(20); "> 주의사항 ! </button>

                            </div>
                        </div>

                    </div>

                    <div id="step20" style="display: none;">  <!--주의사항 --------------------------------------------->

                        <table border="1">

                            <tbody><tr><td>
                                    <ul>
                                        <li>본 내용은 세법과 위의 기본사항 요건에 한정하여 본인이 입력한 데이터로 산출한 “상황별 예상세금 모의계산”으로서 예상세금 단순비교를 위한
                                            평가내용입니다. </li>
                                        <li>이용자의 개별적인 의사결정에 대한 법적 책임은 없습니다.</li>
                                        <li>따라서 실제 의사결정 및 관련 세무신고는 사전에 세무사와 반드시 상담하기기 바랍니다.</li>
                                    </ul>
                                </td>

                            </tr></tbody></table><br><br>


                            <button onclick="saveAllData()">입력 데이터 저장</button> <br>  
                            <p>
                                ፠ 입력한 데이터는 사용자의 컴퓨터 웹브라우저에서만 저장되며, 외부로 유출되지 않습니다.
                                <div class="no-print"><a href="https://tuzaga.com/%eb%a1%9c%ec%bb%ac-%ec%8a%a4%ed%86%a0%eb%a6%ac%ec%a7%80-%eb%b8%8c%eb%9d%bc%ec%9a%b0%ec%a0%80%ec%97%90-%ec%a0%80%ec%9e%a5%ed%95%9c%eb%8b%a4%eb%8a%94-%ea%b2%83%ec%9d%98-%ec%9d%98%eb%af%b8/" target="_blank" rel="noopener noreferrer">자세히 알아보기</a></div>
                            </p> <br><br>

                            <button onclick="window.print()" class="no-print">프린트</button> <br><br>

                        <div style="display: flex; flex-direction: column; align-items: left; gap: 10px;">

                            <div style="display: flex; justify-content:left ; gap: 20px;">
                                <button onclick="previousStep(19); ">뒤로가기</button>
                                <button class="clickable" data-target="step12" style="padding: 5px 10px;">목록</button>

                            </div>
                        </div>

                    </div>


                </div>
            </div>
        </div>
    </div>
</section>
<script>
    function nextStep(stepNum) {
        document.getElementById("step" + (stepNum - 1)).style.display = "none";
        document.getElementById("step" + stepNum).style.display = "block";
    }


    function previousStep(stepNum) {
        document.getElementById("step" + (stepNum + 1)).style.display = "none";
        document.getElementById("step" + stepNum).style.display = "block";
        document.getElementById("results").style.display = "none";


    }


    //상속세 계산기
    function calculateInheritanceTax(inheritanceDeduction) {
        let houseValue = parseFloat(document.getElementById('houseValue').value.replace(/,/g, '')) || 0;
        let buildingValue = parseFloat(document.getElementById('buildingValue').value.replace(/,/g, '')) || 0;
        let agriculturalLandValue = parseFloat(document.getElementById('agriculturalLandValue').value.replace(/,/g, '')) || 0;
        let forestLandValue = parseFloat(document.getElementById('forestLandValue').value.replace(/,/g, '')) || 0;
        let otherProperty = parseFloat(document.getElementById('otherProperty').value.replace(/,/g, '')) || 0;
        let debts = parseFloat(document.getElementById('debts').value.replace(/,/g, '')) || 0;
        let childrensNumber = parseInt(document.getElementById('childrensNumber').value) || 0; // 자녀 수 입력 받음

        let funeralExpenseInput = parseFloat(document.getElementById('funeralExpense').value.replace(/,/g, ''));

        // 입력값이 숫자가 아니거나(Not a Number, 즉 입력이 비어 있거나 숫자가 아닌 경우) 5,000,000보다 작은지 확인
        if (isNaN(funeralExpenseInput) || funeralExpenseInput < 5000000) {
            funeralExpenseInput = 5000000; // 입력값이 비어 있거나 5,000,000보다 작을 경우 기본값으로 5,000,000 설정
        }

        // 이제 입력값은 최소 5,000,000임이 보장됩니다
        let funeralExpense = funeralExpenseInput; // 입력값 또는 기본값을 사용

        // 입력값이 15,000,000을 초과하는 경우 15,000,000으로 설정
        if (funeralExpense > 15000000) {
            funeralExpense = 15000000;                }


        let giftFromMother = parseFloat(document.getElementById('giftFromMother').value.replace(/,/g, '')) || 0;
        let giftToChildren = parseFloat(document.getElementById('giftToChildren').value.replace(/,/g, '')) || 0;
        let giftToOthers = parseFloat(document.getElementById('giftToOthers').value.replace(/,/g, '')) || 0;


        let appraisalFeeInput = parseFloat(document.getElementById('appraisalFee').value.replace(/,/g, '')) || 0; // 사용자 입력값을 숫자로 변환
        let appraisalFee = appraisalFeeInput > 5000000 ? 5000000 : appraisalFeeInput; // 입력값이 500만원을 초과하면 500만원으로 설정, 그렇지 않으면 입력값 사용


        let giftTaxDeduction = parseFloat(document.getElementById('giftTaxDeduction').value.replace(/,/g, '')) || 0;


        let totalProperty = houseValue + buildingValue + agriculturalLandValue + forestLandValue + otherProperty;
        let priorGifts = giftFromMother + giftToChildren + giftToOthers;
        let taxableAmount = totalProperty - debts - funeralExpense + priorGifts;


        let taxBase = Math.max(0, taxableAmount - inheritanceDeduction - appraisalFee);
        let calculatedTax = calculateInheritTariff(taxBase); calculatedTax = Math.floor(calculatedTax); // 소수점 이하를 절사하여 할당
        let taxDeduction = giftTaxDeduction + (calculatedTax -giftTaxDeduction) * 0.03; taxDeduction = Math.floor(taxDeduction); // 소수점 이하를 절사하여 할당
        let payableTax = Math.max(0, calculatedTax - taxDeduction);payableTax = Math.floor(payableTax / 10) * 10; // 10의 자리를 절사하여 할당




        document.getElementById('totalPropertyValueCell').innerText = totalProperty.toLocaleString();
        document.getElementById('debtsValueCell').innerText = debts.toLocaleString();
        document.getElementById('funeralExpenseValueCell').innerText = funeralExpense.toLocaleString();
        document.getElementById('priorGiftsValueCell').innerText = priorGifts.toLocaleString();
        document.getElementById('taxableAmountValueCell').innerText = taxableAmount.toLocaleString();
        document.getElementById('inheritanceDeductionValueCell').innerText = inheritanceDeduction.toLocaleString();
        document.getElementById('appraisalFeeValueCell').innerText = appraisalFee.toLocaleString();
        document.getElementById('taxBaseValueCell').innerText = taxBase.toLocaleString();
        document.getElementById('calculatedTaxValueCell').innerText = calculatedTax.toLocaleString();
        document.getElementById('taxDeductionValueCell').innerText = taxDeduction.toLocaleString();
        document.getElementById('payableTaxValueCell').innerText = payableTax.toLocaleString();


        return payableTax;
    }


    // 상속세율표


    function calculateInheritTariff(taxBase) {
        if (taxBase <= 100000000) {
            return taxBase * 0.1; // 10%
        } else if (taxBase <= 500000000) {
            return taxBase * 0.2 - 10000000; // 20%, 10,000,000원 공제
        } else if (taxBase <= 1000000000) {
            return taxBase * 0.3 - 60000000; // 30%, 60,000,000원 공제
        } else if (taxBase <= 3000000000) {
            return taxBase * 0.4 - 160000000; // 40%, 160,000,000원 공제
        } else {
            return taxBase * 0.5 - 460000000; // 50%, 460,000,000원 공제
        }
    }


    function formatNumber(input) {
        // Remove commas and non-numeric characters
        let numericValue = input.value.replace(/,/g, '').replace(/\D/g, '');
        // Format with commas and update the input value
        input.value = numericValue.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    function calculateSpouseInheritanceDeduction() {
        let houseValue = parseFloat(document.getElementById('houseValue').value.replace(/,/g, '')) || 0;
        let buildingValue = parseFloat(document.getElementById('buildingValue').value.replace(/,/g, '')) || 0;
        let agriculturalLandValue = parseFloat(document.getElementById('agriculturalLandValue').value.replace(/,/g, '')) || 0;
        let forestLandValue = parseFloat(document.getElementById('forestLandValue').value.replace(/,/g, '')) || 0;
        let otherProperty = parseFloat(document.getElementById('otherProperty').value.replace(/,/g, '')) || 0;
        let debts = parseFloat(document.getElementById('debts').value.replace(/,/g, '')) || 0;
        let giftFromMother = parseFloat(document.getElementById('giftFromMother').value.replace(/,/g, '')) || 0;
        let giftToChildren = parseFloat(document.getElementById('giftToChildren').value.replace(/,/g, '')) || 0;
        let giftToOthers = parseFloat(document.getElementById('giftToOthers').value.replace(/,/g, '')) || 0;
        let childrensNumber = parseInt(document.getElementById('childrensNumber').value) || 0; // 자녀 수 입력 받음


        let inheritedProperty = houseValue + buildingValue + agriculturalLandValue + forestLandValue + otherProperty +  giftFromMother + giftToChildren - debts; // 상속재산 가액
        let spouseInheritanceDeduction = Math.min(
            inheritedProperty * (1.5 / (childrensNumber + 1.5)) - Math.max(giftFromMother - 600000000, 0),
            3000000000
        ); // 배우자 상속공제 한도 계산

        spouseInheritanceDeduction = Math.max(spouseInheritanceDeduction, 500000000); // 최소 5억으로 설정
        spouseInheritanceDeduction = Math.floor(spouseInheritanceDeduction); //소수점 이하를 절사하여 할당

        document.getElementById('spouseInheritanceDeductionCell').innerText = spouseInheritanceDeduction.toLocaleString(); // 배우자 상속공제 한도 결과를 표시할 셀에 값을 설정

    }

    // 동거주택상속공제 계    
    function formatNumber(input) {
            let value = input.value.replace(/\D/g, "").replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            input.value = value;
            return value;
        }
        function openCohabitationModal() {
            let modal = document.getElementById('cohabitationModal');
            let houseValue = document.getElementById('houseValue').value;
            document.getElementById('modalHouseValueCell').textContent = houseValue;
            modal.style.display = "block";
        }

        function closeCohabitationModal() {
            document.getElementById('cohabitationModal').style.display = "none";
        }

       function calculateCohabitationDeduction() {
    let notApplicable = document.getElementById('notApplicableCheckbox').checked;
    
    if (notApplicable) {
        document.getElementById('cohabitationDeduction').textContent = '0';
        document.getElementById('houseValue').disabled = true;
        document.getElementById('houseDebt').disabled = true;
    } else {
        document.getElementById('houseValue').disabled = false;
        document.getElementById('houseDebt').disabled = false;
        
        let houseValue = parseFloat(document.getElementById('houseValue').value.replace(/,/g, '')) || 0;
        let houseDebt = parseFloat(document.getElementById('houseDebt').value.replace(/,/g, '')) || 0;
        let deduction = Math.max(houseValue - houseDebt, 0);
        deduction = Math.min(deduction, 600000000); // 6억 한도
        document.getElementById('cohabitationDeduction').textContent = formatNumber({value: deduction.toString()});
    }
    
    // 총 공제액 업데이트
    updateTotalDeduction();
}

        function applyCohabitationDeduction() {
            let deduction = document.getElementById('cohabitationDeduction').textContent;
            document.getElementById('cohabitationDeductionAmount').textContent = deduction;
            closeCohabitationModal();

            document.getElementById('cohabitationDeductionAmount').textContent = deduction;
            updateTotalDeduction();
            closeCohabitationModal();
                }

        window.onclick = function(event) {
            let modal = document.getElementById('cohabitationModal');
            if (event.target == modal) {
                closeCohabitationModal();
            }
        }

    // 금융상속공제 계산 
    function openFinancialModal() {
        document.getElementById('financialModal').style.display = "block";
        }

        function closeFinancialModal() {
            document.getElementById('financialModal').style.display = "none";
        }

        function calculateFinancialDeduction() {
            let financialAssets = parseFloat(document.getElementById('financialAssets').value.replace(/,/g, '')) || 0;
            let financialDebts = parseFloat(document.getElementById('financialDebts').value.replace(/,/g, '')) || 0;
            let netFinancialAssets = Math.max(financialAssets - financialDebts, 0);
            let financialDeduction;

            if (netFinancialAssets <= 20000000) {
                financialDeduction = netFinancialAssets;
            } else {
                financialDeduction = Math.min(Math.max(netFinancialAssets * 0.2, 20000000), 200000000);
            }

            document.getElementById('financialDeductionResult').textContent = formatNumber({value: financialDeduction.toString()});
        }

        function applyFinancialDeduction() {
            let finalDeduction = document.getElementById('financialDeductionResult').textContent;
            document.getElementById('finalFinancialDeductionAmount').textContent = finalDeduction;
            closeFinancialModal();

            document.getElementById('finalFinancialDeductionAmount').textContent = finalDeduction;
            updateTotalDeduction();
            closeFinancialModal();
        }

        window.onclick = function(event) {
            let modal = document.getElementById('financialModal');
            if (event.target == modal) {
                closeFinancialModal();
            }
        }

    // 기초공제 + 인적공제와 일괄공제 비교 
    let calculatedDeduction = 0;

function openInheritanceModal() {
    document.getElementById('inheritanceModal').style.display = "block";
}

function closeInheritanceModal() {
    document.getElementById('inheritanceModal').style.display = "none";
    document.getElementById('applyButton').style.display = "none";
    document.getElementById('deductionResult').innerHTML = "";
}

document.getElementById('deductionForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const children = parseInt(document.getElementById('children').value);
    const minors = parseInt(document.getElementById('minors').value);
    const minorYears = parseInt(document.getElementById('minorYears').value);
    const seniors = parseInt(document.getElementById('seniors').value);

    // 인적공제 계산
    const childDeduction = children * 50000000;
    const minorDeduction = minors * 10000000 * minorYears;
    const seniorDeduction = seniors * 50000000;
    const personalDeduction = childDeduction + minorDeduction + seniorDeduction;

    // 일괄공제 계산
    const basicDeduction = 200000000;
    calculatedDeduction = Math.max(basicDeduction + personalDeduction, 500000000);

    // 결과 표시
    const resultDiv = document.getElementById('deductionResult');
    resultDiv.innerHTML = `
        <p>공제결과</p>
        <p>자녀 공제: ${childDeduction.toLocaleString()}원</p>
        <p>미성년자 공제: ${minorDeduction.toLocaleString()}원</p>
        <p>65세 이상 공제: ${seniorDeduction.toLocaleString()}원</p>
        <p>인적공제 합계: ${personalDeduction.toLocaleString()}원</p>
        <p>기초공제: ${basicDeduction.toLocaleString()}원</p>
        <p>최종 인적공제 금액: ${calculatedDeduction.toLocaleString()}원</p>
    `;

    document.getElementById('applyButton').style.display = "block";
 });

 function applyDeduction() {
    document.getElementById('finalDeductionAmount').textContent = calculatedDeduction.toLocaleString(); updateTotalDeduction();
    closeInheritanceModal();
 }

  window.onclick = function(event) {
    let modal = document.getElementById('inheritanceModal');
    if (event.target == modal) {
        closeInheritanceModal();
    }
}

    // 공제액을 합계 내는 함수

    function updateTotalDeduction() {
    let spouseDeduction = parseFloat(document.getElementById('spouseInheritanceDeductionCell').innerText.replace(/,/g, '')) || 0;
    let cohabitationDeduction = parseFloat(document.getElementById('cohabitationDeductionAmount').innerText.replace(/,/g, '')) || 0;
    let financialDeduction = parseFloat(document.getElementById('finalFinancialDeductionAmount').innerText.replace(/,/g, '')) || 0;
    let basicDeduction = parseFloat(document.getElementById('finalDeductionAmount').innerText.replace(/,/g, '')) || 0;

    let totalDeduction = spouseDeduction + cohabitationDeduction + financialDeduction + basicDeduction;
    
    document.getElementById('totalDeductionResult').textContent = totalDeduction.toLocaleString();
    
    let inheritanceDeduction2Input = document.getElementById('inheritanceDeduction2');
    if (inheritanceDeduction2Input) {
        inheritanceDeduction2Input.value = totalDeduction.toLocaleString();
    } else {
        console.error('inheritanceDeduction2 element not found');
    }
}

document.addEventListener('DOMContentLoaded', function() {
    updateTotalDeduction();
    // 이 코드는 DOM이 로드된 후 실행되며, inheritanceDeduction2 요소가 존재하는지 확인합니다. 요소가 없으면 콘솔에 오류 메시지를 출력합니다. 이 방법으로 문제를 더 쉽게 진단할 수 있을 것입니다.
});


   // 상속공제에 따른 상속세 비교
   function performDeductionComparison() {
        let inheritanceDeduction1 = parseFloat(document.getElementById('inheritanceDeduction1').value) || 0;
        let inheritanceDeduction2 = parseFloat(document.getElementById('inheritanceDeduction2').value.replace(/,/g, '')) || 0;

        let taxForDeduction1 = calculateInheritanceTax(inheritanceDeduction1);
        let taxForDeduction2 = calculateInheritanceTax(inheritanceDeduction2);

        // 상속세 절세 계산
        let taxSavings = taxForDeduction1 - taxForDeduction2;

        // 결과를 HTML에 표시
        document.getElementById('result').innerHTML = `
            <table border="1">
                <thead>
                    <tr>
                        <th>구분</th>
                        <th>상속세</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>10억 상속공제 시 상속세</td>
                        <td>${taxForDeduction1.toLocaleString()}</td>
                    </tr>
                    <tr>
                        <td>위 상속공제 다 받을시 상속세 </td>
                        <td>${taxForDeduction2.toLocaleString()}</td>
                    </tr>
                    <tr>
                        <td>절세되는 상속세 금액</td>
                        <td>${taxSavings.toLocaleString()}</td>
                    </tr>
                </tbody>
            </table>
        `;
    }

   // 목록에서 클릭시 해당 스텝으로 이동
   document.addEventListener('DOMContentLoaded', function() {
    const clickableElements = document.querySelectorAll('.tip, .back-link');
    
    clickableElements.forEach(element => {
        element.addEventListener('click', function() {
            const targetId = this.getAttribute('data-target');
            const targetElement = document.getElementById(targetId);
            
            if (targetElement) {
                // 모든 step 요소를 숨김
                document.querySelectorAll('[id^="step"]').forEach(step => {
                    step.style.display = 'none';
                });
                
                // 대상 요소만 표시
                targetElement.style.display = 'block';
                
                // 대상 요소로 스크롤
                targetElement.scrollIntoView({ behavior: 'smooth' });
            } else {
                console.log(`Element with id ${targetId} not found`);
            }
        });
    });
});


    // 상속취득세 계산 , 중복방지위해  houseValue buildingValue 대신  houseValue1, buildingValue1
    function calculateInheritAcquisionTax() {
        const houseValue1 = parseInt(document.getElementById('houseValue1').value.replace(/,/g, '')) || 0;
        const houseType = document.getElementById('houseType').value.replace(/,/g, '') || 0;
        const buildingValue1 = parseInt(document.getElementById('buildingValue1').value.replace(/,/g, '')) || 0;
        const landValue = parseInt(document.getElementById('landValue').value.replace(/,/g, '')) || 0;
        const farmlandValue = parseInt(document.getElementById('farmlandValue').value.replace(/,/g, '')) || 0;

        const houseTax = InheritAcTaxDetail(houseValue1, 2.8, houseType === 'small' ? 0 : 0.2, 0.16);
        const buildingTax = InheritAcTaxDetail(buildingValue1, 2.8, 0.2, 0.16);
        const landTax = InheritAcTaxDetail(landValue, 2.8, 0.2, 0.16);
        const farmlandTax = InheritAcTaxDetail(farmlandValue, 2.3, 0.2, 0.06);

        const totalAcquisitionTax = houseTax[0] + buildingTax[0] + landTax[0] + farmlandTax[0];
        const totalAgtax = houseTax[1] + buildingTax[1] + landTax[1] + farmlandTax[1];
        const totalEduTax = houseTax[2] + buildingTax[2] + landTax[2] + farmlandTax[2];
        const totalTax = totalAcquisitionTax + totalAgtax + totalEduTax;

        displayTax('house', houseTax);
        displayTax('building', buildingTax);
        displayTax('land', landTax);
        displayTax('farmland', farmlandTax);

        document.getElementById('totalAcquisitionTax').textContent = totalAcquisitionTax.toLocaleString();
        document.getElementById('totalAgtax').textContent = totalAgtax.toLocaleString();
        document.getElementById('totalEduTax').textContent = totalEduTax.toLocaleString();
        document.getElementById('totalTax').textContent = totalTax.toLocaleString();
    }

    function InheritAcTaxDetail(value, acquisitionRate, agtaxRate, eduTaxRate) {
        const acquisitionTax = Math.round(value * acquisitionRate / 100);
        const agtax = Math.round(value * agtaxRate / 100);
        const eduTax = Math.round(value * eduTaxRate / 100);
        return [acquisitionTax, agtax, eduTax];
    }

    function displayTax(type, tax) {
        document.getElementById(type + 'AcquisitionTax').textContent = tax[0].toLocaleString();
        document.getElementById(type + 'Agtax').textContent = tax[1].toLocaleString();
        document.getElementById(type + 'EduTax').textContent = tax[2].toLocaleString();
        document.getElementById(type + 'TotalTax').textContent = (tax[0] + tax[1] + tax[2]).toLocaleString();
    }

    // 재산세 계산 함수
    function calc_property_tax(gongsiBefore, gongsiAfter, owned_houses, ownedHousesAfter) {
        // 1세대 1주택 여부에 따른 과세표준 비율 결정
        let taxBaseRateBefore = 0.6; // 기본값으로 다주택일 경우 세율 적용
        let taxBaseRateAfter = 0.6;

        if (owned_houses <= 1) {
            if (gongsiBefore <= 300000000) {
                taxBaseRateBefore = 0.43; // 3억 이하
            } else if (gongsiBefore <= 600000000) {
                taxBaseRateBefore = 0.44; // 6억 이하
            } else {
                taxBaseRateBefore = 0.45; // 6억 초과
            }
        }

        if (ownedHousesAfter <= 1) {
            if (gongsiAfter <= 300000000) {
                taxBaseRateAfter = 0.43; // 3억 이하
            } else if (gongsiAfter <= 600000000) {
                taxBaseRateAfter = 0.44; // 6억 이하
            } else {
                taxBaseRateAfter = 0.45; // 6억 초과
            }
        }

        // 과세표준 계산
        let taxBaseBefore = gongsiBefore * taxBaseRateBefore;
        let taxBaseAfter = gongsiAfter * taxBaseRateAfter;

        // 재산세 계산 로직
        let propertyTaxBefore, propertyTaxAfter;

        if (gongsiBefore <= 900000000 && owned_houses === 1) {
            // 상속 전: 9억 이하 공시가격 구간, 1주택인 경우 (낮은 세율 적용)
            if (taxBaseBefore <= 60000000) {
                propertyTaxBefore = taxBaseBefore * 0.0005;
            } else if (taxBaseBefore <= 150000000) {
                propertyTaxBefore = 30000 + (taxBaseBefore - 60000000) * 0.001;
            } else if (taxBaseBefore <= 300000000) {
                propertyTaxBefore = 120000 + (taxBaseBefore - 150000000) * 0.002;
            } else {
                propertyTaxBefore = 420000 + (taxBaseBefore - 300000000) * 0.0035;
            }
        } else {
            // 상속 전: 9억 초과 공시가격 구간 또는 2주택 이상인 경우 (높은 세율 적용)
            if (taxBaseBefore <= 60000000) {
                propertyTaxBefore = taxBaseBefore * 0.001;
            } else if (taxBaseBefore <= 150000000) {
                propertyTaxBefore = 60000 + (taxBaseBefore - 60000000) * 0.0015;
            } else if (taxBaseBefore <= 300000000) {
                propertyTaxBefore = 195000 + (taxBaseBefore - 150000000) * 0.0025;
            } else {
                propertyTaxBefore = 570000 + (taxBaseBefore - 300000000) * 0.004;
            }
        }

        if (gongsiAfter <= 900000000 && ownedHousesAfter <= 1) {
            // 상속 후: 9억 이하 공시가격 구간, 1주택 이하인 경우 (낮은 세율 적용)
            if (taxBaseAfter <= 60000000) {
                propertyTaxAfter = taxBaseAfter * 0.0005;
            } else if (taxBaseAfter <= 150000000) {
                propertyTaxAfter = 30000 + (taxBaseAfter - 60000000) * 0.001;
            } else if (taxBaseAfter <= 300000000) {
                propertyTaxAfter = 120000 + (taxBaseAfter - 150000000) * 0.002;
            } else {
                propertyTaxAfter = 420000 + (taxBaseAfter - 300000000) * 0.0035;
            }
        } else {
            // 상속 후: 9억 초과 공시가격 구간 또는 2주택 이상인 경우 (높은 세율 적용)
            if (taxBaseAfter <= 60000000) {
                propertyTaxAfter = taxBaseAfter * 0.001;
            } else if (taxBaseAfter <= 150000000) {
                propertyTaxAfter = 60000 + (taxBaseAfter - 60000000) * 0.0015;
            } else if (taxBaseAfter <= 300000000) {
                propertyTaxAfter = 195000 + (taxBaseAfter - 150000000) * 0.0025;
            } else {
                propertyTaxAfter = 570000 + (taxBaseAfter - 300000000) * 0.004;
            }
        }

        // 도시계획세 계산
        let dosiTaxBefore = taxBaseBefore * 0.0014;
        let dosiTaxAfter = taxBaseAfter * 0.0014;

        // 지방교육세 계산
        let eduTaxBefore = propertyTaxBefore * 0.2;
        let eduTaxAfter = propertyTaxAfter * 0.2;

        // 상속 전후의 세금 합계 계산
        let totalTaxBefore = propertyTaxBefore + dosiTaxBefore + eduTaxBefore;
        let totalTaxAfter = propertyTaxAfter + dosiTaxAfter + eduTaxAfter;

        // 계산된 세금 값들과 세금 합계를 객체로 반환, 세금을 정수로 반올림
        return {
            propertyTaxBefore: Math.floor(propertyTaxBefore),
            dosiTaxBefore: Math.floor(dosiTaxBefore),
            eduTaxBefore: Math.floor(eduTaxBefore),
            propertyTaxAfter: Math.floor(propertyTaxAfter),
            dosiTaxAfter: Math.floor(dosiTaxAfter),
            eduTaxAfter: Math.floor(eduTaxAfter),
            totalTaxBefore: Math.floor(totalTaxBefore),
            totalTaxAfter: Math.floor(totalTaxAfter)
        };
    }

    function comparePropertyTax() {
        // HTML에서 주택 공시가격 정보 가져오기
        const gongsi_1 = parseFloat(document.getElementById("gongsi_1").value.replace(/,/g, '')) || 0;
        const gongsi_2 = parseFloat(document.getElementById("gongsi_2").value.replace(/,/g, '')) || 0;
        const owned_houses = parseInt(document.getElementById("owned_houses").value.replace(/,/g, ''), 10) || 0;

        // 상속 후의 소유 주택 수 계산
        const ownedHousesAfter = owned_houses + 1;

        // 상속 전후의 주택 공시가격 합산
        const gongsiBefore = gongsi_1;
        const gongsiAfter = gongsi_1 + gongsi_2;

        // 상속 전후의 재산세 계산
        const taxes = calc_property_tax(gongsiBefore, gongsiAfter, owned_houses, ownedHousesAfter);

        // 결과 표시 설정
        document.getElementById("resultTableProperty").style.display = "table";
        document.getElementById("property_tax_1").textContent = taxes.propertyTaxBefore.toLocaleString()  ;
        document.getElementById("dosi_tax_1").textContent = taxes.dosiTaxBefore.toLocaleString() ;
        document.getElementById("p_edu_tax_1").textContent = taxes.eduTaxBefore.toLocaleString() ;
        document.getElementById("total_tax_1").textContent = taxes.totalTaxBefore.toLocaleString() ;
        document.getElementById("property_tax_2").textContent = taxes.propertyTaxAfter.toLocaleString() ;
        document.getElementById("dosi_tax_2").textContent = taxes.dosiTaxAfter.toLocaleString() ;
        document.getElementById("p_edu_tax_2").textContent = taxes.eduTaxAfter.toLocaleString() ;
        document.getElementById("total_tax_2").textContent = taxes.totalTaxAfter.toLocaleString();

        return {
            before: taxes.propertyTaxBefore,
            after: taxes.propertyTaxAfter
        };
    }


    // 종합부동산세 계산 함수
    function calculateComprehensiveTax(gongsi, owned_houses, age, period, property_tax) {
        // 공제액 계산 (주택 수에 따라 결정), 상속 전 보유주택이 1주택이라면 상속주택이 있어도 12억원 공제
        let deduction = owned_houses <= 1 ? 1200000000 : 900000000;

        // 공정시장가액 비율 (0.6으로 고정)
        let fair_value_ratio = 0.6;

        // 과세표준 계산
        let tax_base = (gongsi - deduction) * fair_value_ratio;
        tax_base = Math.max(tax_base, 0);

// 종부세 세액 계산
        let tax = comprehensiveTax(tax_base, owned_houses);


// 공제할 재산세 계산
        let deductible_property_tax = (tax_base * 0.6 / (gongsi * 0.6)) * property_tax;
        deductible_property_tax = isNaN(deductible_property_tax) ? 0 : deductible_property_tax;

// 종합부동산산출세액 계산 (종부세 세액 - 공제할 재산세)
        let comprehensive_tax = tax - deductible_property_tax;
        comprehensive_tax = isNaN(comprehensive_tax) ? 0 : comprehensive_tax;

// 연령별 세액공제율 계산
        let age_deduction_rate = 0;
        if (age >= 60 && age < 65) {
            age_deduction_rate = 0.2;
        } else if (age >= 65 && age < 70) {
            age_deduction_rate = 0.3;
        } else if (age >= 70) {
            age_deduction_rate = 0.4;
        }

// 연령별 세액공제액 계산
        let age_deduction = calComDeduction(comprehensive_tax, age_deduction_rate, 0.8);
        age_deduction = isNaN(age_deduction) ? 0 : age_deduction;

// 보유기간별 세액공제율 계산
        let period_deduction_rate = 0;
        if (period >= 5 && period < 10) {
            period_deduction_rate = 0.2;
        } else if (period >= 10 && period < 15) {
            period_deduction_rate = 0.4;
        } else if (period >= 15) {
            period_deduction_rate = 0.5;
        }

// 보유기간별 세액공제액 계산
        let period_deduction = calComDeduction(comprehensive_tax, period_deduction_rate, 0.8);
        period_deduction = isNaN(period_deduction) ? 0 : period_deduction;

// 납부할 세액 계산
        let payable_tax = comprehensive_tax - age_deduction - period_deduction;
        payable_tax = isNaN(payable_tax) ? 0 : payable_tax;

// 농어촌특별세 계산 (납부할 세액의 20%)
        let rural_tax = payable_tax * 0.2;
        rural_tax = isNaN(rural_tax) ? 0 : rural_tax;

// 납부할 세액과 농어촌특별세의 합계 계산
        let total_tax = payable_tax + rural_tax;
        total_tax = isNaN(total_tax) ? 0 : total_tax;

        // 결과 반환
        return {
            tax_base: tax_base,
            tax: tax,
            deductible_property_tax: deductible_property_tax,
            comprehensive_tax: comprehensive_tax,
            age_deduction: age_deduction,
            period_deduction: period_deduction,
            payable_tax: payable_tax,
            rural_tax: rural_tax,
            total_tax: total_tax
        };
    }

    // 세액 계산 함수
    function comprehensiveTax(tax_base, owned_houses) {
        let tax = 0;

        // 주택 수에 따른 세율 적용
        if (owned_houses <= 2) {
            // 2주택 이하인 경우의 세율 적용
            if (tax_base <= 300000000) {
                tax = tax_base * 0.005;
            } else if (tax_base <= 600000000) {
                tax = tax_base * 0.007 - 600000;
            } else if (tax_base <= 1200000000) {
                tax = tax_base * 0.01 - 2400000;
            } else if (tax_base <= 2500000000) {
                tax = tax_base * 0.013 - 6000000;
            } else if (tax_base <= 5000000000) {
                tax = tax_base * 0.015 - 11000000;
            } else if (tax_base <= 9400000000) {
                tax = tax_base * 0.02 - 36000000;
            } else {
                tax = tax_base * 0.027 - 101800000;
            }
        } else {
            // 3주택 이상인 경우의 세율 적용
            if (tax_base <= 300000000) {
                tax = tax_base * 0.005;
            } else if (tax_base <= 600000000) {
                tax = tax_base * 0.007 - 600000;
            } else if (tax_base <= 1200000000) {
                tax = tax_base * 0.01 - 2400000;
            } else if (tax_base <= 2500000000) {
                tax = tax_base * 0.02 - 14400000;
            } else if (tax_base <= 5000000000) {
                tax = tax_base * 0.03 - 39400000;
            } else if (tax_base <= 9400000000) {
                tax = tax_base * 0.04 - 89400000;
            } else {
                tax = tax_base * 0.05 - 183400000;
            }
        }

        return tax;
    }

    // 세액공제액 계산 함수
    function calComDeduction(comprehensive_tax, deduction_rate, limit) {
        let deduction = comprehensive_tax * deduction_rate;
        deduction = Math.min(deduction, comprehensive_tax * limit);
        return deduction;
    }

    // 계산 실행 함수
    function compareComprehensiveTax() {
        // 입력값 가져오기
        let gongsi_1 = parseInt(document.getElementById('gongsi_1').value.replace(/,/g, '')) || 0;
        let gongsi_2 = parseInt(document.getElementById('gongsi_2').value.replace(/,/g, '')) || 0;
        let owned_houses = parseInt(document.getElementById('owned_houses').value.replace(/,/g, '')) || 0;
        let age = parseInt(document.getElementById('age').value) || 0;
        let period = parseInt(document.getElementById('period').value) || 0;

        // 재산세 비교 계산기 함수 호출하여 상속 전후 재산세 값 가져오기
        const propertyTaxes = comparePropertyTax();

        // 상속 전후 계산 결과 저장
        let result1 = calculateComprehensiveTax(gongsi_1, owned_houses, age, period, propertyTaxes.before);
        let result2 = calculateComprehensiveTax(gongsi_1 + gongsi_2, owned_houses, age, period, propertyTaxes.after);

        // 결과 테이블 생성
        let table = '<table border="1">';
        table += '<tr><th></th><th>상속 전</th><th>상속 후</th></tr>';
        table += '<tr><td>과세표준</td><td>' + (Math.floor(result1.tax_base / 10) * 10).toLocaleString('ko-KR') + '</td><td>' + (Math.floor(result2.tax_base / 10) * 10).toLocaleString('ko-KR') + '</td></tr>';
        table += '<tr><td>종합부동산세액</td><td>' + (Math.floor(result1.tax / 10) * 10).toLocaleString('ko-KR') + '</td><td>' + (Math.floor(result2.tax / 10) * 10).toLocaleString('ko-KR') + '</td></tr>';
        table += '<tr><td>공제할 재산세액</td><td>' + (Math.floor(result1.deductible_property_tax / 10) * 10).toLocaleString('ko-KR') + '</td><td>' + (Math.floor(result2.deductible_property_tax / 10) * 10).toLocaleString('ko-KR') + '</td></tr>';
        table += '<tr><td>종합부동산산출세액</td><td>' + (Math.floor(result1.comprehensive_tax / 10) * 10).toLocaleString('ko-KR') + '</td><td>' + (Math.floor(result2.comprehensive_tax / 10) * 10).toLocaleString('ko-KR') + '</td></tr>';
        table += '<tr><td>연령별 세액공제</td><td>' + (Math.floor(result1.age_deduction / 10) * 10).toLocaleString('ko-KR') + '</td><td>' + (Math.floor(result2.age_deduction / 10) * 10).toLocaleString('ko-KR') + '</td></tr>';
        table += '<tr><td>보유기간 세액공제</td><td>' + (Math.floor(result1.period_deduction / 10) * 10).toLocaleString('ko-KR') + '</td><td>' + (Math.floor(result2.period_deduction / 10) * 10).toLocaleString('ko-KR') + '</td></tr>';
        table += '<tr><td>납부할 세액</td><td>' + (Math.floor(result1.payable_tax / 10) * 10).toLocaleString('ko-KR') + '</td><td>' + (Math.floor(result2.payable_tax / 10) * 10).toLocaleString('ko-KR') + '</td></tr>';
        table += '<tr><td>농어촌특별세</td><td>' + (Math.floor(result1.rural_tax / 10) * 10).toLocaleString('ko-KR') + '</td><td>' + (Math.floor(result2.rural_tax / 10) * 10).toLocaleString('ko-KR') + '</td></tr>';
        table += '<tr><td>총 납부세액</td><td>' + (Math.floor(result1.total_tax / 10) * 10).toLocaleString('ko-KR') + '</td><td>' + (Math.floor(result2.total_tax / 10) * 10).toLocaleString('ko-KR') + '</td></tr>';
        table += '</table>';

        // 결과 출력
        document.getElementById('resultComprehensiveTax').innerHTML = table;
    }

    // 상속후 양도세 계산 함수들 

    let results = {};

    

    function syncTransferPrice() {
        document.getElementById('transferPrice3').value = document.getElementById('transferPrice2').value;
    }

    function syncHoldingPeriod() {
        document.getElementById('holdingPeriod3').value = document.getElementById('holdingPeriod2').value;
    }

    function syncNonBusinessUse() {
        document.getElementById('nonBusinessUse3').checked = document.getElementById('nonBusinessUse2').checked;
    }

    function calculateAllTaxes() {
       calculateTaxes('1');
       calculateTaxes('2');
       calculateTaxes('3');
        updateResultTable();
    }

    function calculateTaxes(section) {
        let transferPrice = parseFloat(document.getElementById('transferPrice' + section).value.replace(/,/g, ''));
        let acquisitionPrice = parseFloat(document.getElementById('acquisitionPrice' + section).value.replace(/,/g, ''));
        let holdingPeriod = section === '1' ? 0.5 : parseFloat(document.getElementById('holdingPeriod' + section).value);
        let isNonBusinessUse = section !== '1' && document.getElementById('nonBusinessUse' + section).checked;

        if (section === '1') {
            document.getElementById('acquisitionPrice1').value = transferPrice.toLocaleString();
            acquisitionPrice = transferPrice;
        }

        let capitalGain = transferPrice - acquisitionPrice;
        let longTermDeduction = calculateLongTermDeduction(capitalGain, holdingPeriod);
        let taxableIncome = capitalGain - longTermDeduction;
        let taxBase = Math.max(0, taxableIncome - (section === '1' ? 0 : 2500000));
        let transferTax = calculateTransferTax(taxBase, holdingPeriod >= 5 && isNonBusinessUse);
        let localIncomeTax = transferTax * 0.1;
        let totalTax = transferTax + localIncomeTax;

        results[section] = {
            transferPrice, acquisitionPrice, capitalGain, longTermDeduction,
            taxableIncome, taxBase, transferTax, localIncomeTax, totalTax
        };
    }

    // 이 함수는 앞서 존재 했던 함수이다.
    function calculateLongTermDeduction(capitalGain, holdingPeriod) {
        let deductionRate = 0;
        if (holdingPeriod >= 3 && holdingPeriod < 4) {
            deductionRate = 0.06;
        } else if (holdingPeriod >= 4 && holdingPeriod < 5) {
            deductionRate = 0.08;
        } else if (holdingPeriod >= 5) {
            deductionRate = Math.min(0.3, 0.02 * holdingPeriod);
        }
        return capitalGain * deductionRate;
    }

    function calculateTransferTax(taxBase, isNonBusinessLongTerm) {
        let additionalRate = isNonBusinessLongTerm ? 0.1 : 0;
        if (taxBase <= 14000000) {
            return taxBase * (0.06 + additionalRate);
        } else if (taxBase <= 50000000) {
            return taxBase * (0.15 + additionalRate) - 1260000;
        } else if (taxBase <= 88000000) {
            return taxBase * (0.24 + additionalRate) - 5760000;
        } else if (taxBase <= 150000000) {
            return taxBase * (0.35 + additionalRate) - 15440000;
        } else if (taxBase <= 300000000) {
            return taxBase * (0.38 + additionalRate) - 19940000;
        } else if (taxBase <= 500000000) {
            return taxBase * (0.40 + additionalRate) - 25940000;
        } else if (taxBase <= 1000000000) {
            return taxBase * (0.42 + additionalRate) - 35940000;
        } else {
            return taxBase * (0.45 + additionalRate) - 65940000;
        }
    }

    function updateResultTable() {
        let tableHtml = `
            <h2>계산 결과</h2>
            <table>
                <tr>
                    <th>구분</th>
                    <th>1) 6개월 이내 양도</th>
                    <th>2) 시가 신고후 양도</th>
                    <th>3) 기준시가 신고후 양도</th>
                    <th>비고</th>
                </tr>
        `;

        const rows = [
            { key: 'transferPrice', label: '양도가액', note: '' },
            { key: 'acquisitionPrice', label: '취득가액', note: '' },
            { key: 'capitalGain', label: '양도차익', note: '양도가액 - 취득가액' },
            { key: 'longTermDeduction', label: '장기보유특별공제', note: '' },
            { key: 'taxableIncome', label: '양도소득금액', note: '양도차익 - 장기보유특별공제' },
            { key: 'taxBase', label: '과세표준', note: '' },
            { key: 'transferTax', label: '양도세', note: '' },
            { key: 'localIncomeTax', label: '지방소득세', note: '양도세 * 10%' },
            { key: 'totalTax', label: '세액합계', note: '양도세 + 지방소득세' }
        ];

        rows.forEach(row => {
            tableHtml += `
                <tr>
                    <td>${row.label}</td>
                    <td>${results['1'] ? results['1'][row.key].toLocaleString() : '-'}</td>
                    <td>${results['2'] ? results['2'][row.key].toLocaleString() : '-'}</td>
                    <td>${results['3'] ? results['3'][row.key].toLocaleString() : '-'}</td>
                    <td>${row.note}</td>
                </tr>
            `;
        });

        tableHtml += '</table>';
        document.getElementById('resultTableTrance').innerHTML = tableHtml;
        document.getElementById('resultTableTrance').style.display = 'block';
    }



    // 기초연금 소득평가액 계산 함수
    function calculateIncomeEvaluation(monthlyWorkIncome, monthlyBusinessIncome, monthlyFinancialIncome, monthlyFreeRentIncome, monthlyPublicTransferIncome) {
        const incomeEvaluation = Math.floor(Math.max(monthlyWorkIncome - 1100000, 0) * 0.7 + monthlyBusinessIncome + monthlyFinancialIncome + monthlyFreeRentIncome + monthlyPublicTransferIncome);
        return incomeEvaluation;
    }

    // 재산소득환산액 계산 함수
    function calculatePropertyIncomeConversion(generalProperty, basicProperty, financialProperty, debt, luxuryCarOver4000, membershipRight, region) {
        let basicPropertyAmount;
        switch (region) {
            case '중소도시':
                basicPropertyAmount = 85000000;
                break;
            case '농어촌':
                basicPropertyAmount = 72500000;
                break;
            default:
                basicPropertyAmount = 135000000; // 대도시를 디폴트 값으로 설정
        }
        const excessProperty = Math.max(generalProperty - basicPropertyAmount, 0);
        const propertyIncomeConversion = Math.floor((excessProperty + (financialProperty - 20000000) - debt) * 0.04 / 12 + luxuryCarOver4000 + membershipRight);
        return { propertyIncomeConversion, basicPropertyAmount, excessProperty };
    }

    function calculateRecognizedIncome(incomeEvaluation, propertyIncomeConversion) {
        const recognizedIncome = Math.max(incomeEvaluation + propertyIncomeConversion, 0);
        return recognizedIncome;
    }

    //소득인정액 계산함수 ( 소득평가액 + 재산소득환산액)
    function calculateIncomeProperty() {
        const monthlyWorkIncome = parseFloat(document.getElementById('monthlyWorkIncome').value.replace(/,/g, '')) || 0;
        const monthlyBusinessIncome = parseFloat(document.getElementById('monthlyBusinessIncome').value.replace(/,/g, '')) || 0;
        const monthlyFinancialIncome = parseFloat(document.getElementById('monthlyFinancialIncome').value.replace(/,/g, '')) || 0;
        const houseStandardPrice = parseFloat(document.getElementById('houseStandardPrice').value.replace(/,/g, '')) || 0;
        const shareRatio = parseFloat(document.getElementById('shareRatio').value.replace(/,/g, '')) || 0;
        const monthlyFreeRentIncome = houseStandardPrice * shareRatio * 0.0078 / 12;
        const monthlyPublicTransferIncome = parseFloat(document.getElementById('monthlyPublicTransferIncome').value.replace(/,/g, '')) || 0;
        const realEstate = parseFloat(document.getElementById('realEstate').value.replace(/,/g, '')) || 0;
        const leaseDeposit = parseFloat(document.getElementById('leaseDeposit').value.replace(/,/g, '')) || 0;
        const generalProperty = realEstate + leaseDeposit * 0.95;
        const financialProperty = parseFloat(document.getElementById('financialProperty').value.replace(/,/g, '')) || 0;
        const debt = parseFloat(document.getElementById('debt').value.replace(/,/g, '')) || 0;
        const luxuryCarOver4000 = parseFloat(document.getElementById('luxuryCarOver4000').value.replace(/,/g, '')) || 0;
        const membershipRight = parseFloat(document.getElementById('membershipRight').value.replace(/,/g, '')) || 0;
        const region = document.getElementById('region').value;

        const incomeEvaluation = calculateIncomeEvaluation(monthlyWorkIncome, monthlyBusinessIncome, monthlyFinancialIncome, monthlyFreeRentIncome, monthlyPublicTransferIncome);
        const { propertyIncomeConversion, basicPropertyAmount, excessProperty } = calculatePropertyIncomeConversion(generalProperty, 0, financialProperty, debt, luxuryCarOver4000, membershipRight, region);
        const recognizedIncome = calculateRecognizedIncome(incomeEvaluation, propertyIncomeConversion);

        const resultElement = document.getElementById('resultPention');

        resultElement.innerHTML = `
        <h3>상세 계산 내역</h3>
        <p class="resultPention"><strong>소득평가액: ${incomeEvaluation.toLocaleString()}원</strong></p>

        <p>
            <ul>
                <li>소득평가액 = (월근로소득 -110만원 )*0.7 + 월 사업소득 +월 금융소득 + 월 무료임차소득 + 월 공적이전소득 </li>
                <li>월 무료임차소득 = 자녀주택의 시가표준액* 지분율 *0.0078 /12 </li>
            </ul>
        </p>


        <p class="resultPention"><strong>재산소득환산액: ${propertyIncomeConversion.toLocaleString()}원</strong></p>

        <p>
            <ul>
                <li>재산소득환산액 = ((일반재산 - 기본재산액) + (금융재산 - 2천만원) - 부채) * 0.04 / 12 + 4천만원 이상 고급자동차 + 회원권</li>
                <li>일반재산 = 부동산등 + 임차보증금*0.95 </li>
                <li>기본재산액 : 대도시 1억 3500만원, 중소도시 8500만원, 농어촌 7250만원을 차감</li>
            </ul>
        </p>

        <h2 class="resultPention"><strong>소득인정액: ${recognizedIncome.toLocaleString()}원<strong></h2>
        
        <p>
            <ul>
                <li>소득인정액 = 소득평가액 + 재산소득환산액</li>
                <li>부부가구인 경우  3,408,000 원 이하인 경우 기초연금 대상</li>
                <li>단독가구인 경우 2,130,000 원 이하인 경우 기초연금 대상</li>
            </ul>

        </p>
      `;
        resultElement.style.display = 'block';
    }

    // 해당자리로 이동하는 함수

    function scrollToTarget(event) {
        var target = event.currentTarget.getAttribute("data-target");
        var targetElement = document.getElementById(target);

        // 모든 step 요소 숨기기
        var stepElements = document.querySelectorAll("[id^='step']");
        stepElements.forEach(function (step) {
            step.style.display = "none";
        });

        // 대상 요소 보이기
        targetElement.style.display = "block";
        targetElement.scrollIntoView({ behavior: "smooth" });
    }

    // 클릭 가능한 요소에 이벤트 리스너 추가
    var clickableElements = document.querySelectorAll(".clickable");
    clickableElements.forEach(function (element) {
        element.addEventListener("click", scrollToTarget);
    });


    // 입력데이터만 로컬스토리지 브라우저에 저장하는 함수

    function saveAllData() {
            const data = {};
            
            // 모든 입력 필드의 값을 수집
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                data[input.id] = input.value;
            });
            
            
            
            // 데이터를 로컬 스토리지에 저장
            localStorage.setItem('inheritanceTaxData', JSON.stringify(data));
            alert('모든 데이터가 저장되었습니다!');
        }
        
        function loadAllData() {
            const savedData = localStorage.getItem('inheritanceTaxData');
            if (savedData) {
                const data = JSON.parse(savedData);
                
                // 모든 입력 필드에 저장된 값을 설정
                Object.keys(data).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        if (element.tagName === 'INPUT' || element.tagName === 'SELECT' || element.tagName === 'TEXTAREA') {
                            element.value = data[key];
                        } else {
                            element.textContent = data[key];
                        }
                    }
                });
                
                alert('저장된 데이터를 불러왔습니다!');
            } else {
                alert('저장된 데이터가 없습니다.');
            }
        }

       

</script>

</body>
</html>