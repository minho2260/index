<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>동거주택 상속공제신고서</title>
    <style>
      body {
            font-family: Arial, sans-serif;
            line-height: 1.4;
            margin: 0;
            padding: 30px;
            font-size: 16px;           
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 0px;
            margin-top: 10px;           
        }
        
        td, th {
        padding: 2px; /* 패딩을 2px로 설정 */
        font-size: 16px; /* 폰트 크기 조정 */
        }

        td {
            border: 1px solid;
            padding: 1px;
            text-align: left;
        }        
        
        /*  위쪽과 아래쪽 굵은 테두리 */
        table tr:first-child {
            border-top: 2px solid #000;
        }
        table tr:last-child {
            border-bottom: 2px solid #000;
        }
        /* 옆쪽 테두리 제거 */
        table, th, td {
            border-left: none;
            border-right: none;
        }

        
        input[type="text"] {
            width: 100%;
            height: 100%;
            padding: 0px;
            box-sizing: border-box;
            font-size: 16px;
        }  

        .result {
            font-weight: bold;
            text-align: right;
            font-size: 16px;
        }
        select, input[type="text"], input[type="number"] {
            width: 100%;
            padding: 5px;
            box-sizing: border-box;           
            text-align: center;
        }
        .checkbox-container {
            display: flex;
            justify-content: space-around;
        }
        .button-container {
            margin-bottom: 10px;
        }
        button {
            margin-right: 10px;
            padding: 5px 10px;
        }
        /* 재산구분선택  */
        .selector {
            cursor: pointer;
           
        }
        
       

/* 인쇄용 스타일 */
@media print {
        /* Set the page size to A4 */
        @page {
            size: A4;
            margin: 15mm; /* Adjust margins as needed */
        }
        
        p, h4, td, th {
            font-size: 8.5pt;
        }

        input[type="text"] {
        padding: 0;
        font-size: 8pt;
        }

        /* Hide elements that shouldn't appear in print */
         /* 인쇄 시 숨기고 싶은 요소 */
        #saveButton, #loadButton, #deleteButton, #printButton {
            display: none;
        }

        /* Adjust table styles for printing */
        table {
            width: 100%;
            font-size: 8pt; /* Adjust font size for print */
        }

        td, th {
            padding: 2px; /* Reduce padding to fit more content */
        }

        /* Additional print-specific styles if needed */
    }

    select {
        -webkit-appearance: none; /* 크롬 및 사파리에서 기본 드롭다운 스타일 제거 */
        appearance: none; /* 기본 드롭다운 스타일 제거 */
        border: none; /* 테두리 제거 */
        background: transparent; /* 배경 제거 */
        box-shadow: none; /* 그림자 제거 */
        font-size: 9pt;
    }
    
        
    </style>
</head>
<body>

    <p style="font-size: 10px; color: #2b2a2a; text-align: left; margin-bottom: -10px;">[별지 제5호서식] (2020.03.13 개정)</p>
    <h2 style="text-align: center; color: #333; margin-bottom: 0px;">동거주택상속공제신고서 </h2>
    <p style="font-size: 10px; color: #2b2a2a; text-align: left; margin-bottom: 0px;">፠ 뒤쪽의 작성방법을 읽고 작성하시기 바랍니다.</p>

    <div style="text-align: right; margin-top: -10px;">
        <button id="saveButton"  style="padding: 10px 20px;">저장</button>
        <button id="loadButton"  style="padding: 10px 20px;">불러오기</button>
        <button id="deleteButton" style="padding: 10px 20px;">삭제</button>
        <button id="printButton"style="padding: 10px 20px;">인쇄</button>
    </div>
    <p><strong>1.신고자</strong></p>
    <table>
        <tr>           
            <td rowspan="2">피상속인</td>
            <td>성명</td> <td><input type="text" name="deceasedName"></td>
            <td>주민등록번호 </td><td><input type="text" name="deceasedID">            
        </tr>
        <tr>
            <td>상속개시일 </td>
            <td colspan="3"><input type="text" name="inheritanceStartDate"></td>
        </tr>
        <tr>           
            <td rowspan="2">신청인<br>(상속인)</td>           
            <td>성명</td>
            <td><input type="text" id="heir-name"></td>
            <td>주민등록번호</td>
            <td><input type="text" id="heir-id-number"></td>
        </tr>
             
        <tr>
            <td>주 소 </td>
            <td colspan="3"><input type="text" name="applicantAddress"></td>
        </tr>
        
    </table>
   
    <p><strong>2. 동거주택 현황</strong></p>
<table>
    <tr>
        <td rowspan="4">동거주택</td>
        <td>소재지</td>
        <td colspan="5"><input type="text" name="propertyLocation"></td>
    </tr>
    <tr>
        <td>취득일</td>
        <td><input type="text" name="acquisitionDate"></td>
        <td>① 동거기간<br><small>(상속인이 미성년자인 기간은 제외)</small></td>
        <td><input type="text" name="cohabitationPeriod"></td>
        <td>② 평가가액 <br><small>(주택가액 - 담보채무액 )</small></td>       
        <td><input type="text" id="propertyValue" name="propertyValue"></td>
    </tr>
    
    <tr>
        <td colspan="3" rowspan="2">③ 상속개시일부터 소급하여 10년이상 계속 <br>1세대 1주택 여부</td>
        <td colspan="3">
            <input type="checkbox" name="isSingleHouse" id="isSingleHouseYes" value="yes">
            <label for="isSingleHouseYes">해당</label>
        </td>
    </tr>
    <tr>
        
        <td>
            <input type="checkbox" name="isSingleHouse" id="isSingleHouseNo" value="no">
            <label for="isSingleHouseNo">해당안됨</label>
        </td>
        <td>④ 예외유형</td>
        <td>
            <select id="exceptionType" name="exceptionType">
                <option value="1">일시적 2주택</option>
                <option value="2">혼인합가주택</option>
                <option value="3">문화재주택</option>
                <option value="4">이농주택</option>
                <option value="5">귀농주택</option>
                <option value="6">동거봉양</option>
                <option value="7">피상속인 혼인합가주택</option>
                <option value="8">공동상속주택 소수지분 소유</option>
            </select>
        </td>
    </tr>    
    
    <tr>
        <td rowspan="7">상속인</td>
        <td rowspan="2">성명</td>
        <td rowspan="2" style="width: 20%;">주민등록번호</td>
        <td rowspan="2">⑤ 동거주택지분 (%)</td>
        <td colspan="2" style="text-align: center; vertical-align: middle;">요건충족 여부</td>
        <td rowspan="2" style="text-align: center; vertical-align: middle;">⑧ 요건충족지분</td>
    </tr>
    <tr>
        <td>⑥ 10년이상 동거</td>
        <td>⑦ 무주택자 <small>(피상속인과 공동으로 1세대 <br> 1주택을 보유한 자 포함)</small> </td>        
    </tr>
    <!-- 상속인 정보 입력 행들을 name 속성으로 수정 -->
    <tr>
        <td><input type="text" name="heirName1"></td>
        <td><input type="text" name="heirID1"></td>
        <td><input type="number" name="heirShare1" step="0.01"></td>
        <td style="text-align: center;"><input type="checkbox" name="heirCondition1_10years"></td>
        <td style="text-align: center;"><input type="checkbox" name="heirCondition1_noHouse"></td>
        <td><input type="text" name="heirEligibleShare1"></td>
    </tr>
    <tr>
        <td><input type="text" name="heirName2"></td>
        <td><input type="text" name="heirID2"></td>
        <td><input type="number" name="heirShare2" step="0.01"></td>
        <td style="text-align: center;"><input type="checkbox" name="heirCondition2_10years"></td>
        <td style="text-align: center;"><input type="checkbox" name="heirCondition2_noHouse"></td>
        <td><input type="text" name="heirEligibleShare2"></td>
    </tr>
    <tr>
        <td><input type="text" name="heirName3"></td>
        <td><input type="text" name="heirID3"></td>
        <td><input type="number" name="heirShare3" step="0.01"></td>
        <td style="text-align: center;"><input type="checkbox" name="heirCondition3_10years"></td>
        <td style="text-align: center;"><input type="checkbox" name="heirCondition3_noHouse"></td>
        <td><input type="text" name="heirEligibleShare3"></td>
    </tr>
    <tr>
        <td><input type="text" name="heirName4"></td>
        <td><input type="text" name="heirID4"></td>
        <td><input type="number" name="heirShare4" step="0.01"></td>
        <td style="text-align: center;"><input type="checkbox" name="heirCondition4_10years"></td>
        <td style="text-align: center;"><input type="checkbox" name="heirCondition4_noHouse"></td>
        <td><input type="text" name="heirEligibleShare4"></td>
    </tr>
    <tr>
        <td style="text-align: center;" colspan="5">⑨ 계</td>
        <td><input type="text" id="totalEligibleAmount" name="totalEligibleAmount" readonly></td>
    </tr>

    

    
</table>

 <p><strong>3.동거주택상속공제</strong></p>

<table>
    
    <tr>
        <td colspan="2">⑩ 동거주택 공제대상액 (② × ⑨)</td>
        <td><input type="text" id="deductionTargetAmount" name="deductionTargetAmount" readonly></td>
    </tr>
    <tr>
        <td rowspan="2">동거주택상속공제 </td>
        <td>⑪ 한도금액 </td>
        <td style="text-align: center;">6억원</td>
    </tr>
    <tr>
        <td>⑫ 동거주택 상속공제액 (⑩과 ⑪ 중 적은 금액)</td>
        <td><input type="text" id="finalDeductionAmount" name="finalDeductionAmount" readonly></td>
    </tr>
</table>



<!-- 날짜 입력 필드 추가 및 기본값 설정 -->
<p>  「상속세 및 증여세법」 제23조의 2 및 같은 법 시행령 제20조의 2에 따라 동거주택 상속공제 신고서를 제출합니다.  <input type="text" id="inputYear" placeholder="년" style="width: 50px;">년
    <input type="text" id="inputMonth" placeholder="월" style="width: 30px;">월
    <input type="text" id="inputDay" placeholder="일" style="width: 30px;">일.
    신고인 <span id="declarerName" style="font-weight: bold;">(서명 또는 인)</span> </p>      

 <p> <input type="text"  style="width: 50px;">세무서장  귀하</p>

<table>
    <tr>
        <td>신청(신고)인   제출서류</td>
        <td>1. 피상속인과 동거주택 상속인이 10년 이상 함께 동거한 사실을 알 수 있는 서류</td>
        <td rowspan="2">수수료 
            없음</td>
    </tr>
    <tr>
        <td>담당공무원  확인사항</td>
        <td>1. 건물 등기사항 증명서  2. 주민등록표등본</td>
    </tr>
</table>

<table>
    <tr>        
        <td  style="text-align: center;" ><strong>행정정보 공동이용 동의서</strong></td>
    </tr>    
    <tr>        
        <td><small>본인은 이 건 업무처리와 관련하여 담당 공무원이 「전자정부법」 제36조제1항에 따른 행정정보의 공동이용을 통하여 위의 담당 
            공무원 확인사항 제2호를 확인하는 것에 동의합니다.  * 동의하지 아니하는 경우에는 신청인이 직접 관련 서류를 제출하여야 합니다.
            신청인 <span id="declarerName" style="font-weight: bold;">(서명 또는 인)</span></small> </td>
    </tr>  

</table>


<script>

function formatNumber(num) {
    // 소수점 이하 절사
    num = Math.floor(num);
    return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

// 쉼표가 포함된 문자열을 숫자로 변환
function unformatNumber(str) {
    return parseFloat(str.replace(/,/g, "")) || 0;
}

// 입력 필드에 천 단위 쉼표 적용
function formatInput(input) {
    let value = input.value.replace(/[^\d]/g, '');
    if (value !== "") {
        value = formatNumber(parseInt(value, 10));
    }
    input.value = value;
}

// 모든 입력 필드에 이벤트 리스너 추가
document.querySelectorAll('input, select').forEach(input => {
    input.addEventListener('input', calculate);
});

// propertyValue 필드에 천 단위 쉼표 적용
document.getElementById('propertyValue').addEventListener('input', function() {
    formatInput(this); // 입력 값에 천 단위 쉼표 적용
});

function calculate() {
    const propertyValue = unformatNumber(document.getElementById('propertyValue').value) || 0;
    const heirs = [];

    // 각 상속인에 대한 정보 수집 및 계산
    for (let i = 1; i <= 4; i++) {
        const heirShare = parseFloat(document.querySelector(`input[name="heirShare${i}"]`).value) || 0;
        const condition10years = document.querySelector(`input[name="heirCondition${i}_10years"]`).checked;
        const conditionNoHouse = document.querySelector(`input[name="heirCondition${i}_noHouse"]`).checked;

        let eligibleShare = 0;
        if (condition10years && conditionNoHouse) {
            eligibleShare = heirShare;
        }

        // 요건충족지분 필드에 값 설정
        document.querySelector(`input[name="heirEligibleShare${i}"]`).value = eligibleShare;

        heirs.push({
            share: heirShare,
            eligibleShare: eligibleShare
        });
    }

    // ⑨ 계 (요건충족 지분의 합계)
    const totalEligibleShare = heirs.reduce((sum, heir) => sum + heir.eligibleShare, 0);
    document.getElementById('totalEligibleAmount').value = totalEligibleShare;

    // ⑩ 동거주택 공제대상액 계산 (② 평가가액 × ⑨ 계)
    const deductionTargetAmount = propertyValue * (totalEligibleShare / 100);
    document.getElementById('deductionTargetAmount').value = formatNumber(deductionTargetAmount);

    // ⑪ 한도금액
    const limitAmount = 600000000; // 6억 원

    // ⑫ 동거주택 상속공제액 (⑩과 ⑪ 중 적은 금액)
    const finalDeductionAmount = Math.min(deductionTargetAmount, limitAmount);
    document.getElementById('finalDeductionAmount').value = formatNumber(finalDeductionAmount);
}

document.addEventListener("DOMContentLoaded", function () {
    // Date auto-fill (current date)
    const currentDate = new Date();
    document.getElementById('inputYear').value = currentDate.getFullYear();
    document.getElementById('inputMonth').value = String(currentDate.getMonth() + 1).padStart(2, '0'); // Month is zero-indexed
    document.getElementById('inputDay').value = String(currentDate.getDate()).padStart(2, '0');

    // Auto-fill 신고인 and 신청인 fields based on 상속인 성명
    const heirNameInput = document.getElementById('heir-name');
    const declarerNameFields = document.querySelectorAll('#declarerName');

    heirNameInput.addEventListener('input', function () {
        declarerNameFields.forEach(field => {
            field.textContent = heirNameInput.value || "(서명 또는 인)";
        });
    });
});

// Save and load functions remain the same
function saveData() {
    const inputs = document.querySelectorAll('input, select');
    const data = {};
    inputs.forEach(input => {
        if (input.name) {
            if (input.type === 'checkbox') {
                data[input.name] = input.checked;
            } else {
                data[input.name] = input.value;
            }
        }
    });
    localStorage.setItem('formData', JSON.stringify(data));
    alert('데이터가 저장되었습니다.');
}

function loadData() {
    const data = JSON.parse(localStorage.getItem('formData'));
    if (data) {
        const inputs = document.querySelectorAll('input, select');
        inputs.forEach(input => {
            if (input.name && data[input.name] !== undefined) {
                if (input.type === 'checkbox') {
                    input.checked = data[input.name];
                } else {
                    input.value = data[input.name];
                }
            }
        });
        calculate(); // 계산 결과 업데이트
        alert('데이터가 불러와졌습니다.');
    } else {
        alert('저장된 데이터가 없습니다.');
    }
}

function deleteData() {
    localStorage.removeItem('formData');
    alert('저장된 데이터가 삭제되었습니다.');
}

// 버튼에 이벤트 리스너 추가
document.getElementById('saveButton').addEventListener('click', saveData);
document.getElementById('loadButton').addEventListener('click', loadData);
document.getElementById('deleteButton').addEventListener('click', deleteData);

// 초기 실행
calculate();

// 인쇄 기능 구현
document.getElementById('printButton').addEventListener('click', function() {
    window.print();
});


</script>

</body>
</html>
